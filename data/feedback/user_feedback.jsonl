{"timestamp": "2025-11-16T19:32:05.121502", "instruction": "test query", "input": "", "generated_output": "index=* | head 10", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-16T19:35:15.102671", "instruction": "Show me all firewall blocks", "input": "", "generated_output": "index=firewall action=block | table timestamp src_ip dest_ip alert.signature alert.category alert.action | sort -timestamp | head 100", "rating": "bad", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-16T19:35:23.624081", "instruction": "Show me all firewall blocks", "input": "", "generated_output": "index=firewall action=block | table timestamp src_ip dest_ip alert.signature alert.category alert.action | sort -timestamp | head 100", "rating": "bad", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-16T19:35:24.431767", "instruction": "Show me all firewall blocks", "input": "", "generated_output": "index=firewall action=block | table timestamp src_ip dest_ip alert.signature alert.category alert.action | sort -timestamp | head 100", "rating": "bad", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-16T19:41:38.904409", "instruction": "Look for any registry changes", "input": "", "generated_output": "index=windows EventCode=4657 | table _time, Computer, Key_Name, Old_Value, New_Value | where isnotnull(Old_Value) AND isnotnull(New_Value) | eval change=if(Old_Value!=New_Value, ", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-17T04:14:19.656947", "user_id": 3, "username": "azferna", "query_id": 1, "instruction": "Find failed SSH login attempts in the last 24 hours", "input": "", "generated_output": "index=* sourcetype=zeek:conn | transaction user, src_ip | where status!=200 AND (status<10 OR status>99) | stats count by user, src_ip | sort -count | head 50 | table _time id.orig_h host user count | timechart span=30m count as total | eval rate = round((total / duration()) * 60, 2) | eval percentage = round(((count / total) * 100), 2) | eval threshold = ((rate > 10) OR (percentage > 5)) | where threshold | table _time id.orig_h host user count rate percentage", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-17T04:19:09.482373", "user_id": 3, "username": "azferna", "query_id": null, "instruction": "Give me a splunk query to identify all ssh connections", "input": "", "generated_output": "index=* sourcetype=", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-17T04:26:07.750470", "user_id": 3, "username": "azferna", "query_id": 3, "instruction": "Show me all RDP connections", "input": "", "generated_output": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 | rex field=Image \"rdp\\.exe\" | table _time Computer User DestinationIP DestinationPort | stats count by Computer, User, DestinationIP, DestinationPort | sort -count | head 20 | eval rank=if(match(_time,\"Jan\") AND match(_time,\"Mon\"),1,0) OR (match(_time,\"Feb\") AND match(_time,\"Tue\"),1,0) OR (match(_time,\"Mar\") AND match(_time,\"Wed\"),1,0) OR (match(_time,\"Apr\") AND match(_time,\"Thu\"),1,0) OR (match(_time,\"May\") AND match(_time,\"Fri\"),1,0) OR (match(_time,\"Jun\") AND match(_time,\"Sat\"),1,0) OR (match(_time,\"Jul\") AND match(_time,\"Sun\"),1,0),rank) | where rank>0 | eval month=_time | eval day=_time | mvexpand month,day | stats count avg(count) as", "rating": "good", "corrected_output": null, "comment": null}
