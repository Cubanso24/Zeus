{"instruction": "test query", "input": "", "output": "index=* | head 10"}
{"instruction": "Look for any registry changes", "input": "", "output": "index=windows EventCode=4657 | table _time, Computer, Key_Name, Old_Value, New_Value | where isnotnull(Old_Value) AND isnotnull(New_Value) | eval change=if(Old_Value!=New_Value, "}
{"instruction": "Find failed SSH login attempts in the last 24 hours", "input": "", "output": "index=* sourcetype=zeek:conn | transaction user, src_ip | where status!=200 AND (status<10 OR status>99) | stats count by user, src_ip | sort -count | head 50 | table _time id.orig_h host user count | timechart span=30m count as total | eval rate = round((total / duration()) * 60, 2) | eval percentage = round(((count / total) * 100), 2) | eval threshold = ((rate > 10) OR (percentage > 5)) | where threshold | table _time id.orig_h host user count rate percentage"}
{"instruction": "Give me a splunk query to identify all ssh connections", "input": "", "output": "index=* sourcetype="}
{"instruction": "Show me all RDP connections", "input": "", "output": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 | rex field=Image \"rdp\\.exe\" | table _time Computer User DestinationIP DestinationPort | stats count by Computer, User, DestinationIP, DestinationPort | sort -count | head 20 | eval rank=if(match(_time,\"Jan\") AND match(_time,\"Mon\"),1,0) OR (match(_time,\"Feb\") AND match(_time,\"Tue\"),1,0) OR (match(_time,\"Mar\") AND match(_time,\"Wed\"),1,0) OR (match(_time,\"Apr\") AND match(_time,\"Thu\"),1,0) OR (match(_time,\"May\") AND match(_time,\"Fri\"),1,0) OR (match(_time,\"Jun\") AND match(_time,\"Sat\"),1,0) OR (match(_time,\"Jul\") AND match(_time,\"Sun\"),1,0),rank) | where rank>0 | eval month=_time | eval day=_time | mvexpand month,day | stats count avg(count) as"}
{"instruction": "show me traffic over ports 80, 443, 22, and 8080", "input": "", "output": "index=network dest_port=80 OR dest_port=443 OR dest_port=22 OR dest_port=8080 | stats sum(bytes) as total_bytes by src_ip, dest_ip | sort -total_bytes | head 50"}
{"instruction": "i want to find all the get requests to non .mil sites", "input": "", "output": "index=* sourcetype=access_combined method=\"GET\" uri!=\"*.mil/*\" | table _time id.orig_h host uri status bytes user agent referrer | where status>=200 AND status<=399 | stats count by host, uri, user, referrer | sort -count | head 15"}
{"instruction": "Get Windows security events with Event ID 4624", "input": "", "output": "index=* sourcetype=wineventlog:Microsoft-Windows-Sysmon/Operational EventCode=4624 | table _time Computer User Image CommandLine DestinationIp DestinationPort Action | stats count by User, Image, DestinationIp, DestinationPort, Action | sort -count"}
{"instruction": "Get Windows security events with Event ID 4624", "input": "", "output": "index=* sourcetype=\"XmlWinEventLog:Security\" EventCode=4624 | table _time Computer User Image DestinationIp DestinationPort Action TargetUserName | stats count by Computer, User, Image, DestinationIp, DestinationPort, Action, TargetUserName"}
{"instruction": "Find failed SSH login attempts in the last 24 hours", "input": "", "output": "index=* sourcetype=\"XmlWinEventLog:Security\" EventCode=4625 earliest=-24h | table _time host user src_ip dest_ip Service DestinationPort Action | where Action=\"Failed\" AND dest_port=22 | stats count by user, src_ip, dest_ip, Service, DestinationPort | sort -count | head 10"}
{"instruction": "Find failed SSH login attempts in the last 72 hours", "input": "", "output": "index=* sourcetype=linux_secure \"Failed password\" earliest=-72h | table _time id.orig_h user src_ip dest_ip service action | stats count by user, src_ip | where count > 50 | sort -count | head 100"}
{"instruction": "Show failed login events in the last week", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"authentication_failed\" | stats count by agent.name, rule.description"}
{"instruction": "Find successful authentication events in the last 7 days", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"authentication_success\" | stats count by agent.name"}
{"instruction": "Get alerts by severity level in the last 30 days", "output": "index=wazuh-alerts earliest=-30d | stats count by rule.level | sort -rule.level"}
{"instruction": "Count alerts per agent in the last 30 days", "output": "index=wazuh-alerts earliest=-30d | stats count by agent.name | sort -count"}
{"instruction": "Show top 10 agents by alert count this week", "output": "index=wazuh-alerts earliest=-7d | stats count by agent.name | sort -count | head 10"}
{"instruction": "Find sudo command executions in the last 7 days", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"sudo\" | stats count by agent.name, rule.description"}
{"instruction": "Show file integrity changes in the last week", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"syscheck\" | stats count by syscheck.event"}
{"instruction": "Find web attacks in the last 30 days", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"web\" | stats count by agent.name, rule.description"}
{"instruction": "Show PAM authentication events this week", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"pam\" | stats count by agent.name"}
{"instruction": "Find audit events in the last 7 days", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"audit\" | stats count by rule.description"}
{"instruction": "Get hourly alert distribution for the last 24 hours", "output": "index=wazuh-alerts earliest=-24h | timechart span=1h count by rule.level"}
{"instruction": "Find the top 10 most common alerts this month", "output": "index=wazuh-alerts earliest=-30d | stats count by rule.description | sort -count | head 10"}
{"instruction": "Count unique rules triggered in the last week", "output": "index=wazuh-alerts earliest=-7d | stats dc(rule.id) as unique_rules"}
{"instruction": "Show alert timeline by hour for the last day", "output": "index=wazuh-alerts earliest=-24h | timechart span=1h count"}
{"instruction": "Find all alerts containing SSH in the description", "output": "index=wazuh-alerts earliest=-7d rule.description=\"*SSH*\" | stats count by rule.description, agent.name"}
{"instruction": "Find password-related events in the last 30 days", "output": "index=wazuh-alerts earliest=-30d rule.description=\"*password*\" | stats count by agent.name, rule.description"}
{"instruction": "Find the latest 50 alerts", "output": "index=wazuh-alerts earliest=-24h | head 50 | table _time agent.name rule.description rule.level"}
{"instruction": "Calculate alert rate per hour for the last week", "output": "index=wazuh-alerts earliest=-7d | timechart span=1h count | stats avg(count) as avg_per_hour"}
{"instruction": "Find agents with more than 100 alerts this week", "output": "index=wazuh-alerts earliest=-7d | stats count by agent.name | where count > 100"}
{"instruction": "Show distribution of alerts by rule group", "output": "index=wazuh-alerts earliest=-7d | stats count by \"rule.groups{}\" | sort -count | head 20"}
{"instruction": "Find rare alerts (fewer than 10 occurrences)", "output": "index=wazuh-alerts earliest=-30d | stats count by rule.description | where count < 10 | sort count"}
{"instruction": "Find Apache forbidden access attempts", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"apache\" \"rule.description\"=\"*forbidden*\" | stats count by agent.name, data.srcip | sort -count"}
{"instruction": "Show high POST request attacks", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.description\"=\"High amount of POST requests*\" | stats count by agent.name, data.srcip | sort -count"}
{"instruction": "Show all file integrity changes in the last week", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"syscheck\" | stats count by agent.name, syscheck.path | sort -count | head 20"}
{"instruction": "Show all attack-related alerts this week", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"attack\" | stats count by agent.name, rule.description | sort -count | head 20"}
{"instruction": "Find reconnaissance activity in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"recon\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Show access denied events", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"access_denied\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Show vulnerability detections in the last month", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"vulnerability-detector\" | stats count by agent.name, data.vulnerability.cve | sort -count | head 20"}
{"instruction": "Find most active agents this week", "input": "", "output": "index=wazuh-alerts earliest=-7d | stats count by agent.name | sort -count | head 10"}
{"instruction": "Show alert distribution by hour for the last 24 hours", "input": "", "output": "index=wazuh-alerts earliest=-24h | timechart span=1h count by rule.level"}
{"instruction": "Find alert trends by day for the last week", "input": "", "output": "index=wazuh-alerts earliest=-7d | timechart span=1d count by \"rule.groups{}\""}
{"instruction": "Show top source IPs causing authentication failures", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"authentication_failed\" | stats count by data.srcip | sort -count | head 10"}
{"instruction": "Find agents with file integrity changes and their paths", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"syscheck\" | stats dc(syscheck.path) as unique_paths, count by agent.name | sort -count"}
{"instruction": "Show web attack sources and their targets", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"web\" \"rule.groups{}\"=\"attack\" | stats count by data.srcip, agent.name | sort -count | head 20"}
{"instruction": "Show authentication failures in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"authentication_failed\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find successful authentication events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"authentication_success\" | stats count by agent.name | sort -count"}
{"instruction": "Show sudo to ROOT executions in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"sudo\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find PAM session events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"pam\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Show CMS brute force attempts in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"appsec\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find web server error codes in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"web\" | stats count by rule.description | sort -count | head 20"}
{"instruction": "Show web access log events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"accesslog\" | stats count by agent.name | sort -count"}
{"instruction": "Find syslog events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"syslog\" | stats count by agent.name, rule.description | sort -count | head 20"}
{"instruction": "Show OSSEC events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"ossec\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find local events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"local\" | stats count by agent.name | sort -count"}
{"instruction": "Show systemd service events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"systemd\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find file modification events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"syscheck_entry_modified\" | stats count by agent.name | sort -count"}
{"instruction": "Show all syscheck file events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"syscheck_file\" | stats count by syscheck.path | sort -count | head 20"}
{"instruction": "Find email-related alerts in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d agent.name=\"mail-mitic\" | stats count by rule.description | sort -count"}
{"instruction": "Show access control events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"access_control\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find Apache-related alerts in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"apache\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Show alerts for OPNSense firewall in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d agent.name=\"OPNSenseCPANEL*\" | stats count by rule.description | sort -count | head 20"}
{"instruction": "Find alerts for control plane servers", "input": "", "output": "index=wazuh-alerts earliest=-30d agent.name=\"cp*.mitic.gov.py\" | stats count by agent.name, rule.description | sort -count | head 20"}
{"instruction": "Show daily alert trends for the last month", "input": "", "output": "index=wazuh-alerts earliest=-30d | timechart span=1d count"}
{"instruction": "Find hourly pattern of alerts in the last week", "input": "", "output": "index=wazuh-alerts earliest=-7d | timechart span=1h count"}
{"instruction": "Count total alerts by rule group in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d | stats count by \"rule.groups{}\" | sort -count"}
{"instruction": "Find unique rules triggered in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d | stats dc(rule.id) as unique_rules, count as total_alerts by agent.name | sort -total_alerts"}
{"instruction": "Show alert rate by agent in the last week", "input": "", "output": "index=wazuh-alerts earliest=-7d | stats count by agent.name | eval alerts_per_day=round(count/7,2) | sort -alerts_per_day"}
{"instruction": "Find agents with authentication issues", "input": "", "output": "index=wazuh-alerts earliest=-30d (\"rule.groups{}\"=\"authentication_failed\" OR \"rule.groups{}\"=\"access_denied\") | stats count by agent.name | where count>10 | sort -count"}
{"instruction": "Show top attackers by source IP", "input": "", "output": "index=wazuh-alerts earliest=-30d (\"rule.groups{}\"=\"attack\" OR \"rule.groups{}\"=\"recon\") | stats count by data.srcip | sort -count | head 15"}
{"instruction": "Find most targeted agents by web attacks", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"web\" \"rule.groups{}\"=\"attack\" | stats count by agent.name | sort -count"}
{"instruction": "Show the latest 100 alerts", "input": "", "output": "index=wazuh-alerts | head 100 | table _time agent.name rule.description rule.level"}
{"instruction": "Show level 13 critical alerts", "input": "", "output": "index=wazuh-alerts earliest=-1y rule.level=13 | table _time agent.name rule.description"}
{"instruction": "Show monthly alert trends for the past year", "input": "", "output": "index=wazuh-alerts earliest=-1y | timechart span=1mon count"}
{"instruction": "Find monthly authentication failures over the year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"authentication_failed\" | timechart span=1mon count by agent.name"}
{"instruction": "Show file integrity changes by month", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"syscheck\" | timechart span=1mon count"}
{"instruction": "Find all vulnerabilities detected this year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"vulnerability-detector\" | stats count by data.vulnerability.cve, agent.name | sort -count"}
{"instruction": "Show vulnerability trends by month", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"vulnerability-detector\" | timechart span=1mon count"}
{"instruction": "Show attack patterns over the past year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"attack\" | timechart span=1mon count by agent.name"}
{"instruction": "Find top persistent attackers this year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"attack\" data.srcip=* | stats count, dc(agent.name) as targets by data.srcip | sort -count | head 20"}
{"instruction": "Show CMS attacks monthly distribution", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"appsec\" | timechart span=1mon count"}
{"instruction": "Find agent uptime based on alert activity", "input": "", "output": "index=wazuh-alerts earliest=-1y | stats min(_time) as first_seen, max(_time) as last_seen, count by agent.name | sort -count"}
{"instruction": "Show which agents had the most file changes", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"syscheck\" | stats dc(syscheck.path) as files_changed, count as events by agent.name | sort -files_changed"}
{"instruction": "Show web attack trends by month", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"web\" \"rule.groups{}\"=\"attack\" | timechart span=1mon count"}
{"instruction": "Find most attacked web servers this year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"web\" \"rule.groups{}\"=\"attack\" | stats count by agent.name | sort -count"}
{"instruction": "Show PAM authentication trends over the year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"pam\" | timechart span=1mon count"}
{"instruction": "Find sudo usage patterns by month", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"sudo\" | timechart span=1mon count by agent.name"}
{"instruction": "Show normal alert rate by day of week", "input": "", "output": "index=wazuh-alerts earliest=-1y | eval day=strftime(_time,\"%A\") | stats count by day"}
{"instruction": "Find alert distribution by hour of day", "input": "", "output": "index=wazuh-alerts earliest=-1y | eval hour=strftime(_time,\"%H\") | stats count by hour | sort hour"}
{"instruction": "Show alerts by rule level distribution", "input": "", "output": "index=wazuh-alerts earliest=-1y | stats count by rule.level | sort rule.level"}
{"instruction": "Find all brute force attempts this year", "input": "", "output": "index=wazuh-alerts earliest=-1y rule.description=\"*brute force*\" | stats count by agent.name, data.srcip | sort -count"}
{"instruction": "Show all forbidden access attempts", "input": "", "output": "index=wazuh-alerts earliest=-1y rule.description=\"*forbidden*\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find reconnaissance activities this year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"recon\" | stats count by agent.name, data.srcip, rule.description | sort -count"}
{"instruction": "deleted files", "input": "", "output": "index=wazuh-alerts rule.groups{}=\"syscheck_entry_deleted\" earliest=-90d@d latest=now | table _raw timestamp agent.name data.filename data.destpath rule.description rule.level"}
{"instruction": "Find all SSH logs", "input": "", "output": "index=wazuh-alerts rule.groups{}=\"sshd\" earliest=-1y@h latest=now | table _raw agent.name data.srcuser command args timestamp duration data.srcport data.dstport data.srcip data.dstip service method proto protocol_version server_version client_version error_message | head 50"}
{"instruction": "Find files with modified MD5 hashes", "output": "index=wazuh-alerts \"rule.groups{}\"=\"syscheck_entry_modified\" | search syscheck.md5_after=* | table _time agent.name syscheck.path syscheck.md5_before syscheck.md5_after"}
{"instruction": "Show modified MD5 hashes for a specific date range", "output": "index=wazuh-alerts \"rule.groups{}\"=\"syscheck_entry_modified\" earliest=\"07/11/2025:00:00:00\" latest=\"07/15/2025:00:00:00\" | search syscheck.md5_after=* | table _time agent.name syscheck.path syscheck.md5_before syscheck.md5_after"}
{"instruction": "Find file integrity changes where hash values changed", "output": "index=wazuh-alerts \"rule.groups{}\"=\"syscheck_entry_modified\" syscheck.changed_attributes{}=\"md5\" OR syscheck.changed_attributes{}=\"sha1\" OR syscheck.changed_attributes{}=\"sha256\" | table _time agent.name syscheck.path syscheck.md5_after syscheck.sha256_after"}
{"instruction": "Get syscheck events showing file modifications with hash changes", "output": "index=wazuh-alerts \"rule.groups{}\"=\"syscheck_entry_modified\" | table _time agent.name syscheck.path syscheck.event syscheck.md5_before syscheck.md5_after syscheck.changed_attributes{}"}
