{"instruction": "test query", "input": "", "output": "index=* | head 10"}
{"instruction": "Look for any registry changes", "input": "", "output": "index=windows EventCode=4657 | table _time, Computer, Key_Name, Old_Value, New_Value | where isnotnull(Old_Value) AND isnotnull(New_Value) | eval change=if(Old_Value!=New_Value, "}
{"instruction": "Find failed SSH login attempts in the last 24 hours", "input": "", "output": "index=* sourcetype=zeek:conn | transaction user, src_ip | where status!=200 AND (status<10 OR status>99) | stats count by user, src_ip | sort -count | head 50 | table _time id.orig_h host user count | timechart span=30m count as total | eval rate = round((total / duration()) * 60, 2) | eval percentage = round(((count / total) * 100), 2) | eval threshold = ((rate > 10) OR (percentage > 5)) | where threshold | table _time id.orig_h host user count rate percentage"}
{"instruction": "Give me a splunk query to identify all ssh connections", "input": "", "output": "index=* sourcetype="}
{"instruction": "Show me all RDP connections", "input": "", "output": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 | rex field=Image \"rdp\\.exe\" | table _time Computer User DestinationIP DestinationPort | stats count by Computer, User, DestinationIP, DestinationPort | sort -count | head 20 | eval rank=if(match(_time,\"Jan\") AND match(_time,\"Mon\"),1,0) OR (match(_time,\"Feb\") AND match(_time,\"Tue\"),1,0) OR (match(_time,\"Mar\") AND match(_time,\"Wed\"),1,0) OR (match(_time,\"Apr\") AND match(_time,\"Thu\"),1,0) OR (match(_time,\"May\") AND match(_time,\"Fri\"),1,0) OR (match(_time,\"Jun\") AND match(_time,\"Sat\"),1,0) OR (match(_time,\"Jul\") AND match(_time,\"Sun\"),1,0),rank) | where rank>0 | eval month=_time | eval day=_time | mvexpand month,day | stats count avg(count) as"}
{"instruction": "show me traffic over ports 80, 443, 22, and 8080", "input": "", "output": "index=network dest_port=80 OR dest_port=443 OR dest_port=22 OR dest_port=8080 | stats sum(bytes) as total_bytes by src_ip, dest_ip | sort -total_bytes | head 50"}
{"instruction": "i want to find all the get requests to non .mil sites", "input": "", "output": "index=* sourcetype=access_combined method=\"GET\" uri!=\"*.mil/*\" | table _time id.orig_h host uri status bytes user agent referrer | where status>=200 AND status<=399 | stats count by host, uri, user, referrer | sort -count | head 15"}
{"instruction": "Get Windows security events with Event ID 4624", "input": "", "output": "index=* sourcetype=wineventlog:Microsoft-Windows-Sysmon/Operational EventCode=4624 | table _time Computer User Image CommandLine DestinationIp DestinationPort Action | stats count by User, Image, DestinationIp, DestinationPort, Action | sort -count"}
{"instruction": "Get Windows security events with Event ID 4624", "input": "", "output": "index=* sourcetype=\"XmlWinEventLog:Security\" EventCode=4624 | table _time Computer User Image DestinationIp DestinationPort Action TargetUserName | stats count by Computer, User, Image, DestinationIp, DestinationPort, Action, TargetUserName"}
{"instruction": "Find failed SSH login attempts in the last 24 hours", "input": "", "output": "index=* sourcetype=\"XmlWinEventLog:Security\" EventCode=4625 earliest=-24h | table _time host user src_ip dest_ip Service DestinationPort Action | where Action=\"Failed\" AND dest_port=22 | stats count by user, src_ip, dest_ip, Service, DestinationPort | sort -count | head 10"}
{"instruction": "Find failed SSH login attempts in the last 72 hours", "input": "", "output": "index=* sourcetype=linux_secure \"Failed password\" earliest=-72h | table _time id.orig_h user src_ip dest_ip service action | stats count by user, src_ip | where count > 50 | sort -count | head 100"}
{"instruction": "Show failed login events in the last week", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"authentication_failed\" | stats count by agent.name, rule.description"}
{"instruction": "Find successful authentication events in the last 7 days", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"authentication_success\" | stats count by agent.name"}
{"instruction": "Get alerts by severity level in the last 30 days", "output": "index=wazuh-alerts earliest=-30d | stats count by rule.level | sort -rule.level"}
{"instruction": "Count alerts per agent in the last 30 days", "output": "index=wazuh-alerts earliest=-30d | stats count by agent.name | sort -count"}
{"instruction": "Show top 10 agents by alert count this week", "output": "index=wazuh-alerts earliest=-7d | stats count by agent.name | sort -count | head 10"}
{"instruction": "Find sudo command executions in the last 7 days", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"sudo\" | stats count by agent.name, rule.description"}
{"instruction": "Show file integrity changes in the last week", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"syscheck\" | stats count by syscheck.event"}
{"instruction": "Find web attacks in the last 30 days", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"web\" | stats count by agent.name, rule.description"}
{"instruction": "Show PAM authentication events this week", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"pam\" | stats count by agent.name"}
{"instruction": "Find audit events in the last 7 days", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"audit\" | stats count by rule.description"}
{"instruction": "Get hourly alert distribution for the last 24 hours", "output": "index=wazuh-alerts earliest=-24h | timechart span=1h count by rule.level"}
{"instruction": "Find the top 10 most common alerts this month", "output": "index=wazuh-alerts earliest=-30d | stats count by rule.description | sort -count | head 10"}
{"instruction": "Count unique rules triggered in the last week", "output": "index=wazuh-alerts earliest=-7d | stats dc(rule.id) as unique_rules"}
{"instruction": "Show alert timeline by hour for the last day", "output": "index=wazuh-alerts earliest=-24h | timechart span=1h count"}
{"instruction": "Find all alerts containing SSH in the description", "output": "index=wazuh-alerts earliest=-7d rule.description=\"*SSH*\" | stats count by rule.description, agent.name"}
{"instruction": "Find password-related events in the last 30 days", "output": "index=wazuh-alerts earliest=-30d rule.description=\"*password*\" | stats count by agent.name, rule.description"}
{"instruction": "Find the latest 50 alerts", "output": "index=wazuh-alerts earliest=-24h | head 50 | table _time agent.name rule.description rule.level"}
{"instruction": "Calculate alert rate per hour for the last week", "output": "index=wazuh-alerts earliest=-7d | timechart span=1h count | stats avg(count) as avg_per_hour"}
{"instruction": "Find agents with more than 100 alerts this week", "output": "index=wazuh-alerts earliest=-7d | stats count by agent.name | where count > 100"}
{"instruction": "Show distribution of alerts by rule group", "output": "index=wazuh-alerts earliest=-7d | stats count by \"rule.groups{}\" | sort -count | head 20"}
{"instruction": "Find rare alerts (fewer than 10 occurrences)", "output": "index=wazuh-alerts earliest=-30d | stats count by rule.description | where count < 10 | sort count"}
