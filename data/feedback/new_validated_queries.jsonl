{"instruction": "Find Apache forbidden access attempts", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"apache\" \"rule.description\"=\"*forbidden*\" | stats count by agent.name, data.srcip | sort -count"}
{"instruction": "Show high POST request attacks", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.description\"=\"High amount of POST requests*\" | stats count by agent.name, data.srcip | sort -count"}
{"instruction": "Show all file integrity changes in the last week", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"syscheck\" | stats count by agent.name, syscheck.path | sort -count | head 20"}
{"instruction": "Show all attack-related alerts this week", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"attack\" | stats count by agent.name, rule.description | sort -count | head 20"}
{"instruction": "Find reconnaissance activity in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"recon\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Show access denied events", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"access_denied\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Show vulnerability detections in the last month", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"vulnerability-detector\" | stats count by agent.name, data.vulnerability.cve | sort -count | head 20"}
{"instruction": "Find most active agents this week", "input": "", "output": "index=wazuh-alerts earliest=-7d | stats count by agent.name | sort -count | head 10"}
{"instruction": "Show alert distribution by hour for the last 24 hours", "input": "", "output": "index=wazuh-alerts earliest=-24h | timechart span=1h count by rule.level"}
{"instruction": "Find alert trends by day for the last week", "input": "", "output": "index=wazuh-alerts earliest=-7d | timechart span=1d count by \"rule.groups{}\""}
{"instruction": "Show top source IPs causing authentication failures", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"authentication_failed\" | stats count by data.srcip | sort -count | head 10"}
{"instruction": "Find agents with file integrity changes and their paths", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"syscheck\" | stats dc(syscheck.path) as unique_paths, count by agent.name | sort -count"}
{"instruction": "Show web attack sources and their targets", "input": "", "output": "index=wazuh-alerts earliest=-7d \"rule.groups{}\"=\"web\" \"rule.groups{}\"=\"attack\" | stats count by data.srcip, agent.name | sort -count | head 20"}
{"instruction": "Show authentication failures in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"authentication_failed\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find successful authentication events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"authentication_success\" | stats count by agent.name | sort -count"}
{"instruction": "Show sudo to ROOT executions in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"sudo\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find PAM session events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"pam\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Show CMS brute force attempts in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"appsec\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find web server error codes in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"web\" | stats count by rule.description | sort -count | head 20"}
{"instruction": "Show web access log events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"accesslog\" | stats count by agent.name | sort -count"}
{"instruction": "Find syslog events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"syslog\" | stats count by agent.name, rule.description | sort -count | head 20"}
{"instruction": "Show OSSEC events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"ossec\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find local events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"local\" | stats count by agent.name | sort -count"}
{"instruction": "Show systemd service events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"systemd\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find file modification events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"syscheck_entry_modified\" | stats count by agent.name | sort -count"}
{"instruction": "Show all syscheck file events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"syscheck_file\" | stats count by syscheck.path | sort -count | head 20"}
{"instruction": "Find email-related alerts in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d agent.name=\"mail-mitic\" | stats count by rule.description | sort -count"}
{"instruction": "Show access control events in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"access_control\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find Apache-related alerts in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"apache\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Show alerts for OPNSense firewall in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d agent.name=\"OPNSenseCPANEL*\" | stats count by rule.description | sort -count | head 20"}
{"instruction": "Find alerts for control plane servers", "input": "", "output": "index=wazuh-alerts earliest=-30d agent.name=\"cp*.mitic.gov.py\" | stats count by agent.name, rule.description | sort -count | head 20"}
{"instruction": "Show daily alert trends for the last month", "input": "", "output": "index=wazuh-alerts earliest=-30d | timechart span=1d count"}
{"instruction": "Find hourly pattern of alerts in the last week", "input": "", "output": "index=wazuh-alerts earliest=-7d | timechart span=1h count"}
{"instruction": "Count total alerts by rule group in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d | stats count by \"rule.groups{}\" | sort -count"}
{"instruction": "Find unique rules triggered in the last 30 days", "input": "", "output": "index=wazuh-alerts earliest=-30d | stats dc(rule.id) as unique_rules, count as total_alerts by agent.name | sort -total_alerts"}
{"instruction": "Show alert rate by agent in the last week", "input": "", "output": "index=wazuh-alerts earliest=-7d | stats count by agent.name | eval alerts_per_day=round(count/7,2) | sort -alerts_per_day"}
{"instruction": "Find agents with authentication issues", "input": "", "output": "index=wazuh-alerts earliest=-30d (\"rule.groups{}\"=\"authentication_failed\" OR \"rule.groups{}\"=\"access_denied\") | stats count by agent.name | where count>10 | sort -count"}
{"instruction": "Show top attackers by source IP", "input": "", "output": "index=wazuh-alerts earliest=-30d (\"rule.groups{}\"=\"attack\" OR \"rule.groups{}\"=\"recon\") | stats count by data.srcip | sort -count | head 15"}
{"instruction": "Find most targeted agents by web attacks", "input": "", "output": "index=wazuh-alerts earliest=-30d \"rule.groups{}\"=\"web\" \"rule.groups{}\"=\"attack\" | stats count by agent.name | sort -count"}
{"instruction": "Show the latest 100 alerts", "input": "", "output": "index=wazuh-alerts | head 100 | table _time agent.name rule.description rule.level"}
{"instruction": "Show level 13 critical alerts", "input": "", "output": "index=wazuh-alerts earliest=-1y rule.level=13 | table _time agent.name rule.description"}
{"instruction": "Show monthly alert trends for the past year", "input": "", "output": "index=wazuh-alerts earliest=-1y | timechart span=1mon count"}
{"instruction": "Find monthly authentication failures over the year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"authentication_failed\" | timechart span=1mon count by agent.name"}
{"instruction": "Show file integrity changes by month", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"syscheck\" | timechart span=1mon count"}
{"instruction": "Find all vulnerabilities detected this year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"vulnerability-detector\" | stats count by data.vulnerability.cve, agent.name | sort -count"}
{"instruction": "Show vulnerability trends by month", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"vulnerability-detector\" | timechart span=1mon count"}
{"instruction": "Show attack patterns over the past year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"attack\" | timechart span=1mon count by agent.name"}
{"instruction": "Find top persistent attackers this year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"attack\" data.srcip=* | stats count, dc(agent.name) as targets by data.srcip | sort -count | head 20"}
{"instruction": "Show CMS attacks monthly distribution", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"appsec\" | timechart span=1mon count"}
{"instruction": "Find agent uptime based on alert activity", "input": "", "output": "index=wazuh-alerts earliest=-1y | stats min(_time) as first_seen, max(_time) as last_seen, count by agent.name | sort -count"}
{"instruction": "Show which agents had the most file changes", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"syscheck\" | stats dc(syscheck.path) as files_changed, count as events by agent.name | sort -files_changed"}
{"instruction": "Show web attack trends by month", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"web\" \"rule.groups{}\"=\"attack\" | timechart span=1mon count"}
{"instruction": "Find most attacked web servers this year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"web\" \"rule.groups{}\"=\"attack\" | stats count by agent.name | sort -count"}
{"instruction": "Show PAM authentication trends over the year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"pam\" | timechart span=1mon count"}
{"instruction": "Find sudo usage patterns by month", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"sudo\" | timechart span=1mon count by agent.name"}
{"instruction": "Show normal alert rate by day of week", "input": "", "output": "index=wazuh-alerts earliest=-1y | eval day=strftime(_time,\"%A\") | stats count by day"}
{"instruction": "Find alert distribution by hour of day", "input": "", "output": "index=wazuh-alerts earliest=-1y | eval hour=strftime(_time,\"%H\") | stats count by hour | sort hour"}
{"instruction": "Show alerts by rule level distribution", "input": "", "output": "index=wazuh-alerts earliest=-1y | stats count by rule.level | sort rule.level"}
{"instruction": "Find all brute force attempts this year", "input": "", "output": "index=wazuh-alerts earliest=-1y rule.description=\"*brute force*\" | stats count by agent.name, data.srcip | sort -count"}
{"instruction": "Show all forbidden access attempts", "input": "", "output": "index=wazuh-alerts earliest=-1y rule.description=\"*forbidden*\" | stats count by agent.name, rule.description | sort -count"}
{"instruction": "Find reconnaissance activities this year", "input": "", "output": "index=wazuh-alerts earliest=-1y \"rule.groups{}\"=\"recon\" | stats count by agent.name, data.srcip, rule.description | sort -count"}
