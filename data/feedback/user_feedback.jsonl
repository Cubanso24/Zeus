{"timestamp": "2025-11-16T19:32:05.121502", "instruction": "test query", "input": "", "generated_output": "index=* | head 10", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-16T19:35:15.102671", "instruction": "Show me all firewall blocks", "input": "", "generated_output": "index=firewall action=block | table timestamp src_ip dest_ip alert.signature alert.category alert.action | sort -timestamp | head 100", "rating": "bad", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-16T19:35:23.624081", "instruction": "Show me all firewall blocks", "input": "", "generated_output": "index=firewall action=block | table timestamp src_ip dest_ip alert.signature alert.category alert.action | sort -timestamp | head 100", "rating": "bad", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-16T19:35:24.431767", "instruction": "Show me all firewall blocks", "input": "", "generated_output": "index=firewall action=block | table timestamp src_ip dest_ip alert.signature alert.category alert.action | sort -timestamp | head 100", "rating": "bad", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-16T19:41:38.904409", "instruction": "Look for any registry changes", "input": "", "generated_output": "index=windows EventCode=4657 | table _time, Computer, Key_Name, Old_Value, New_Value | where isnotnull(Old_Value) AND isnotnull(New_Value) | eval change=if(Old_Value!=New_Value, ", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-17T04:14:19.656947", "user_id": 3, "username": "azferna", "query_id": 1, "instruction": "Find failed SSH login attempts in the last 24 hours", "input": "", "generated_output": "index=* sourcetype=zeek:conn | transaction user, src_ip | where status!=200 AND (status<10 OR status>99) | stats count by user, src_ip | sort -count | head 50 | table _time id.orig_h host user count | timechart span=30m count as total | eval rate = round((total / duration()) * 60, 2) | eval percentage = round(((count / total) * 100), 2) | eval threshold = ((rate > 10) OR (percentage > 5)) | where threshold | table _time id.orig_h host user count rate percentage", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-17T04:19:09.482373", "user_id": 3, "username": "azferna", "query_id": null, "instruction": "Give me a splunk query to identify all ssh connections", "input": "", "generated_output": "index=* sourcetype=", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-11-17T04:26:07.750470", "user_id": 3, "username": "azferna", "query_id": 3, "instruction": "Show me all RDP connections", "input": "", "generated_output": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 | rex field=Image \"rdp\\.exe\" | table _time Computer User DestinationIP DestinationPort | stats count by Computer, User, DestinationIP, DestinationPort | sort -count | head 20 | eval rank=if(match(_time,\"Jan\") AND match(_time,\"Mon\"),1,0) OR (match(_time,\"Feb\") AND match(_time,\"Tue\"),1,0) OR (match(_time,\"Mar\") AND match(_time,\"Wed\"),1,0) OR (match(_time,\"Apr\") AND match(_time,\"Thu\"),1,0) OR (match(_time,\"May\") AND match(_time,\"Fri\"),1,0) OR (match(_time,\"Jun\") AND match(_time,\"Sat\"),1,0) OR (match(_time,\"Jul\") AND match(_time,\"Sun\"),1,0),rank) | where rank>0 | eval month=_time | eval day=_time | mvexpand month,day | stats count avg(count) as", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-01T15:07:25.163318", "user_id": 3, "username": "raelee.walker", "query_id": 30, "instruction": "Get Windows security events with Event ID 4624", "input": "", "generated_output": "index=windows sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 Image=\"*winword.exe\" (EventCode=4624 OR EventCode=4703) | table _time Computer User Image CommandLine EventCode NewProcessId ParentImage ParentCommandLine | stats count by Computer, User, Image, CommandLine, EventCode, NewProcessId, ParentImage, ParentCommandLine | where count > 50 | sort -count | head 50", "rating": "bad", "corrected_output": "index=windows sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 Image=\"*winword.exe\" EventCode=4624 | table _time Computer User Image CommandLine EventCode NewProcessId ParentImage ParentCommandLine | stats count by Computer, User, Image, CommandLine, EventCode, NewProcessId, ParentImage, ParentCommandLine | where count > 50 | sort -count | head 50", "comment": null}
{"timestamp": "2025-12-01T15:16:02.038909", "user_id": 3, "username": "raelee.walker", "query_id": 35, "instruction": "show me domain policy changes that occurred in the last 24 hours", "input": "", "generated_output": "index=windows EventCode=4769 earliest=-24h | table _time host user old_value new_value GpoName PolicyChangeType | where isnotnull(old_value) AND isnotnull(new_value) | sort -_time | head 50", "rating": "bad", "corrected_output": "index=windows EventCode=4739 earliest=-24h latest=now | sort -_time | head 50", "comment": null}
{"timestamp": "2025-12-01T15:18:36.370975", "user_id": 3, "username": "raelee.walker", "query_id": 36, "instruction": "show me traffic over ports 80, 443, 22, and 8080", "input": "", "generated_output": "index=network dest_port=80 OR dest_port=443 OR dest_port=22 OR dest_port=8080 | stats sum(bytes) as total_bytes by src_ip, dest_ip | sort -total_bytes | head 50", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-01T18:17:41.322762", "user_id": 6, "username": "krovito", "query_id": 62, "instruction": "i want to find all the get requests to non .mil sites", "input": "", "generated_output": "index=* sourcetype=access_combined method=\"GET\" uri!=\"*.mil/*\" | table _time id.orig_h host uri status bytes user agent referrer | where status>=200 AND status<=399 | stats count by host, uri, user, referrer | sort -count | head 15", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-01T18:21:27.917492", "user_id": 3, "username": "raelee.walker", "query_id": 65, "instruction": "Get Windows security events with Event ID 4624", "input": "", "generated_output": "index=* sourcetype=wineventlog:Microsoft-Windows-Sysmon/Operational EventCode=4624 | table _time Computer User Image CommandLine DestinationIp DestinationPort Action | stats count by User, Image, DestinationIp, DestinationPort, Action | sort -count", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-01T18:21:30.025248", "user_id": 3, "username": "raelee.walker", "query_id": 64, "instruction": "Get Windows security events with Event ID 4624", "input": "", "generated_output": "index=* sourcetype=\"XmlWinEventLog:Security\" EventCode=4624 | table _time Computer User Image DestinationIp DestinationPort Action TargetUserName | stats count by Computer, User, Image, DestinationIp, DestinationPort, Action, TargetUserName", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-01T20:14:15.566006", "user_id": 1, "username": "admin", "query_id": 67, "instruction": "Find failed SSH login attempts in the last 24 hours", "input": "", "generated_output": "index=* sourcetype=\"XmlWinEventLog:Security\" EventCode=4625 earliest=-24h | table _time host user src_ip dest_ip Service DestinationPort Action | where Action=\"Failed\" AND dest_port=22 | stats count by user, src_ip, dest_ip, Service, DestinationPort | sort -count | head 10", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-01T20:29:33.520439", "user_id": 1, "username": "admin", "query_id": 70, "instruction": "Find failed SSH login attempts in the last 72 hours", "input": "", "generated_output": "index=* sourcetype=linux_secure \"Failed password\" earliest=-72h | table _time id.orig_h user src_ip dest_ip service action | stats count by user, src_ip | where count > 50 | sort -count | head 100", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-08T17:39:26.860504", "user_id": 7, "username": "Jhawkins", "query_id": 91, "instruction": "search for powershell", "input": "", "generated_output": "index=wazuh-alerts sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 Image=\"*powershell*\" | table _time host user CommandLine CommandLineArguments CommandLineArguments_cleaned CommandLine_parts Image ParentImage CommandLine_hash Checksum_orig Execution_engine User_domain Computer Destination_ip Destination_port Destination_user | stats count by Computer, Destination_ip, Destination_port, Destination_user, CommandLine_hash, checksum(CommandLine_hash), checksum(Checksum_orig) as new_checksum by Computer, Destination_ip, Destination_port, Destination_user, CommandLine_hash | where new_checksum!=Checksum_orig AND new_checksum!=\"\" | sort -Computer,-Destination_ip,-Destinaion_port,-Destinaion_user,-CommandLine_hash | head 50", "rating": "bad", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-08T19:01:21.516346", "user_id": 10, "username": "afernandez", "query_id": 103, "instruction": "Create a query that gets the total number of EDR logs of internet requests responding with a 400 error.", "input": "", "generated_output": "index=wazuh-alerts sourcetype=wazuh_edr eventType=\"Internet\" statusCode=400 | stats count by src_ip, dest_ip | sort -count | head 100 | table _time id.orig_h src_ip dest_ip count", "rating": "bad", "corrected_output": "index=\"wazuh-alerts\" \"rule.groups{}\"=attack | search \"data.id\"=400", "comment": null}
{"timestamp": "2025-12-08T21:25:05.617490", "user_id": 10, "username": "afernandez", "query_id": 172, "instruction": "Give me a query that idenitifes any EDR logs that mention Trojaned version of file", "input": "", "generated_output": "index=wazuh-alerts rule.description=\"*Trojan*\" | table _time agent.name data.srcuser file_path command_line process_id parent_process_id | where isnotnull(file_path) AND isnotnull(parent_process_id) | stats count by file_path, parent_process_id", "rating": "bad", "corrected_output": "index=\"wazuh-alerts\" \"rule.groups{}\"=\"*\"  \"rule.groups{}\"=rootcheck| search \"data.title\"=\"Trojaned version of file detected.\"", "comment": null}
{"timestamp": "2025-12-09T13:59:50.309081", "user_id": 8, "username": "jrafael", "query_id": 273, "instruction": "deleted files", "input": "", "generated_output": "index=wazuh-alerts rule.groups{}=\"syscheck_entry_deleted\" earliest=-90d@d latest=now | table _raw timestamp agent.name data.filename data.destpath rule.description rule.level", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-09T14:04:10.873494", "user_id": 9, "username": "nrudman", "query_id": 276, "instruction": "Find all SSH logs", "input": "", "generated_output": "index=wazuh-alerts rule.groups{}=\"sshd\" earliest=-1y@h latest=now | table _raw agent.name data.srcuser command args timestamp duration data.srcport data.dstport data.srcip data.dstip service method proto protocol_version server_version client_version error_message | head 50", "rating": "good", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-09T14:18:22.372849", "user_id": 14, "username": "sbenitez", "query_id": 278, "instruction": "find all remote connections from external ips", "input": "", "generated_output": "index=wazuh-alerts data.srcip!=internal_ip | rex field=_raw \"^[^\\s]+(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\" data.srcip=\\1 | where _time > \"-1y@h\" AND _time < now() | table timestamp, data.srcip, data.destip, data.destport, data.protocol, rule.groups{}", "rating": "bad", "corrected_output": null, "comment": null}
{"timestamp": "2025-12-09T19:51:56.339745", "user_id": 7, "username": "Jhawkins", "query_id": 300, "instruction": "query for modified md5 hashes for july 11th 2025 through july 14th 2025", "input": "", "generated_output": "index=wazuh-alerts rule.groups{}=\"file\" [search index=predecoder earliest=-24h@h latest=now | fields md5] | where strftime(_time,\"%m-%d-%Y\") BETWEEN \"07-11-2025\" AND \"07-14-2025\" | stats count by agent.name, md5", "rating": "bad", "corrected_output": null, "comment": null}
