{
  "overall_metrics": {
    "exact_match": 0.0,
    "normalized_exact_match": 0.0,
    "token_overlap": 38.28780519785742,
    "command_accuracy": 31.832453261024686,
    "syntax_validity": 97.61904761904762,
    "clarification_accuracy": 98.4126984126984,
    "num_examples": 126
  },
  "examples": [
    {
      "id": 0,
      "prediction": "index=zeek sourcetype=conn | where dest_port > 1024 | table _time id.orig_h host user dest_ip dest_port service proto action | sort -dest_port, -action | head 50 | stats count by src_ip, dest_ip, dest_port | eval percentage = round((count/sum(count))*100, 2) | sort -percentage | head 10 | eval total_connections = sum(count) | info total_connections",
      "reference": "sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=3 DestinationPort>10000 | table _time Computer Image DestinationIp DestinationPort",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.13043478260869565,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show connections to high ports"
    },
    {
      "id": 1,
      "prediction": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 | bin _time span=30m | stats count by _time, src_ip, dest_ip | where count > 5 AND count < 20 | eval interval = ((count * 30) / (sum(count))) | where interval >= 90 AND interval <= 180 | sort -interval | head 10 | table _time, src_ip, dest_ip, count, interval",
      "reference": "index=network dest_port=443 | bucket _time span=1m | stats count by _time, src_ip, dest_ip | eventstats stdev(count) as std_dev avg(count) as avg_count by src_ip, dest_ip | where std_dev < 2 AND avg_count > 5",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.4193548387096774,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Identify beaconing activity based on regular intervals"
    },
    {
      "id": 2,
      "prediction": "index=* | stats dc(user_agent) as unique_agents by uri, host | sort -unique_agents | head 20 | table _time id.orig_h uri unique_agents | where unique_agents > 15 | eval percentage = round((unique_agents / (eval total_users = count)) * 100, 2) | eval rank = if(percentage < 3, \"Low\", IF(percentage >= 3 AND percentage <= 6, \"Medium\", \"High\")) | sort -rank | head 10 | table _time id.orig_h uri unique_agents percentage rank",
      "reference": "index=web | stats dc(user_agent)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.12244897959183675,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "How many distinct user agents have accessed my website?"
    },
    {
      "id": 3,
      "prediction": "index=* sourcetype=\"zeek:conn\" | stats dc(dest_port) as unique_ports, values(dest_port) as ports by src_ip, dest_ip | where unique_ports > 20 | sort -unique_ports | head 10 | table _time, src_ip, dest_ip, unique_ports | eval scan_rate = round((unique_ports / (24 * 60)) * 60, 2) | eval total_ports = count | where scan_rate > 50 | sort -scan_rate | head 3 | info host=$src_ip | stats count avg(packets) max(packets) min(packets) by dest_ip | where packets > 90 | sort -packets | head 10 | table _time, dest_ip, packets | eval packet_rate = round(((packets / (24 * 60)) * 60), 2) | eval connection_count = count | where connection_count > 10 | sort -connection_count | head 5 | table _time, dest_ip, connection_count | eval connections_per_hour = round((connection_count / (24)), 2) | eval average_connections = round((avg(packets) + max(packets) + min(packets))/3, 2) | eval average_connections_per_hour = round((average_connections / (24)), 2) | eval netflow_volume = round((avg(packets)*8)/1000, 2) | eval netflow_volume_mb = round((netflow_volume*1024)/1000, 2) | eval netflow_volume_gb = round((netflow_volume_mb/1024), 2) | eval netflow_volume_tb = round((netflow_volume_gb/1024), 2) | eval netflow_volume_petabytes = round((netflow_volume_tb*1024), 2) | eval netflow_volume_exabytes = round((netflow_volume_petabytes/1024), 2) | eval netflow_volume_zettabytes = round((netflow",
      "reference": "index=* sourcetype=zeek:conn | stats dc(dest_port) as unique_ports, values(dest_port) as ports by src_ip, dest_ip | where unique_ports > 20",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.32967032967032966,
      "command_accuracy": 0.5,
      "syntax_valid": false,
      "clarification_match": 1.0,
      "instruction": "Detect port scanning activity"
    },
    {
      "id": 4,
      "prediction": "index=web | stats avg(response_time) by uri, method | sort -avg(response_time) | head 10 | eval rank = _rank | where rank <= 5 | table uri, method, avg(response_time), rank",
      "reference": "index=web | stats avg(response_time) as avg_response_time by uri",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3448275862068965,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Calculate average response time for web requests"
    },
    {
      "id": 5,
      "prediction": "index=* account | eval compromise_score=if(match(account, \"(admin|root)\") AND match(action, \"(login|access)\"), 10, 5) | sort -compromise_score | head 20 | table _time id.orig_h host user action | where (user=\"jsmith\" OR user=\"sjones\") | stats count by user | where count > 3 | search index=* dest=*malware* | stats count as malware_count by src_ip, dest_ip | join [search] [eval] using ip | where malware_count>0 | stats sum(malware_count) as total_malware by user | where total_malware>5 | sort -total_malware | head 10 | table user, total_malware | eval alert_message=\"Account {user} has been compromised with a score of {alert.severity}. Malware detected on source IP {src_ip}.\" | mvccreate alert_message | info | table _time, alert_message | streamstats window=60 count as alerts_in_window by user | where alerts_in_window>2 | sort -alerts_in_window | head 10 | table user, alerts_in_window | eval alert_message=\"User {user} is under attack! Alerted {alert.severity} times in the last hour.\" | mvccreate alert_message | info | table _time, alert_message",
      "reference": "CLARIFICATION: To detect compromised accounts, please specify:\n- Specific accounts to investigate or all accounts?\n- What indicators (impossible travel, unusual login times, new devices, multiple failed attempts)?\n- Time range for detection?\n- Which authentication systems (Windows AD, VPN, web apps, all)?\n- Threshold for suspicious behavior?",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.032,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 0.0,
      "instruction": "Find compromised accounts"
    },
    {
      "id": 6,
      "prediction": "index=* sourcetype=zeek:dns | eval query_length=len(query) | where query_length > 50 | stats count avg(query_length) by src_ip, query | where count > 10 AND query IN (*google.com*) | sort -count | head 20 | table _time id.orig_h query count | rex field=\"id.orig_h\" \"([^.]+\\.[^.]+\\.[^.]+\\.){3}[^\\.]+\" | stats dc(id.orig_h) as unique_ips by query | where unique_ips > 5 | sort -unique_ips | head 10 | table _time query unique_ips | join [search index=* sourcetype=zeek:http | fields _time id.orig_h uri] | where uri IN (*admin.php*) OR uri IN (*cmd.exe*) | table _time id.orig_h query uri | join [search index=* sourcetype=zeek:smb | fields _time id.orig_h path user] | where path IN (\"*.txt\") OR path IN (\"*.doc\") | table _time id.orig_h query uri path user | join [search index=* sourcetype=zeek:rdp | fields _time id.orig_h session_id] | where session_id NOT NULL | table _time id.orig_h query uri path user session_id | join [search index=* sourcetype=zeek:pe | fields _time id.orig_h command_line] | where command_line=\"powershell.exe\" OR command_line=\"cmd.exe\" | table _time id.orig_h query uri path user session_id command_line | join [search index=* sourcetype=zeek:conn | fields _time id.resp_h service] | where service=\"ssh\" OR service=\"https\" | table _time id.orig_h query uri path user session_id command_line id.resp_h service | join [search index=* sourcetype=zeek:ssl | fields _time server_name client_certificate] | where client_certificate IS NOT NULL | table _time id.orig_h query uri path user session_id command",
      "reference": "index=* sourcetype=zeek:dns | eval query_length=len(query) | where query_length > 50 | stats count avg(query_length) by src_ip, query | where count > 10",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.36781609195402304,
      "command_accuracy": 0.4615384615384615,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Identify DNS tunneling attempts"
    },
    {
      "id": 7,
      "prediction": "index=web | transaction session_id | eval page_sequence=\"|\".join(page) | search \"session_id\" IN (*) | stats count by session_id, page_sequence | sort -count | head 10 | table _time id.orig_h host uri action status session_id page_sequence | rex field=action \"(?<verb>[^ ]+)\" | eval verb_lower=strtolower(verb) | where (verb_lower=\"get\") OR (verb_lower=\"post\") | mvexpand session_id page_sequence | join [search index=* | fields session_id] as user | table _time id.orig_h host uri action status session_id page_sequence user.name | sort -status | head 25",
      "reference": "index=web | stats list(uri_path) as page_flow by session_id",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.22222222222222218,
      "command_accuracy": 0.16666666666666669,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Map the path of a user's journey across the website, showing the sequence of pages visited."
    },
    {
      "id": 8,
      "prediction": "index=* sourcetype=zeek:conn proto=tcp | table _time, src_ip, dest_ip, bytes | sort -bytes | head 20 | stats count avg(bytes) by src_ip, dest_ip | where count > 10 | eval total = sum(bytes) | sort -total | head 5 | table _time, src_ip, dest_ip, bytes, total | eval percentage = round((bytes/total)*100,2) | format percentage as \"%.2f%%\" | table _time, src_ip, dest_ip, bytes, total, percentage",
      "reference": "index=* sourcetype=zeek:conn proto=tcp",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.1621621621621622,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get all tcp traffic logs"
    },
    {
      "id": 9,
      "prediction": "index=* sourcetype=zeek:ssl validation_status!=ok | table _time, src_ip, server_name, validation_status, error_message | sort -_time | head 10",
      "reference": "index=* sourcetype=zeek:ssl validation_status!=ok | table _time, src_ip, server_name, validation_status",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.6956521739130435,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show SSL certificate anomalies"
    },
    {
      "id": 10,
      "prediction": "index=* dest=db-server action=failure | stats count by src_ip, user | where count > 50 | sort -count | head 20 | table _time, src_ip, user, count | eval threshold=(count/10) as percent | where percent > 30 | exec alert=\"Possible brute force\" message=\"Source IP ${src_ip} has triggered more than 30 failed authentication attempts to db-server in the last hour.\" | stats count avg(count) max(count) min(count) by user | where count > (avg(count)*0.8) AND count < (avg(count)*1.2) | eval warning_threshold=(avg(count)/2) as average | where count > warning_threshold | exec alert=\"Warning: High failure rate for user ${user}\" message=\"User ${user} is experiencing a high failure rate of authentications to db-server. Current failure rate is ${round((count/warning_threshold),2)} times the average.\" | stats count avg(count) max(count) min(count) by src_ip | where count > (avg(count)*0.6) AND count < (avg(count)*1.4) | eval info_threshold=(avg(count)/4) as baseline | where count > info_threshold | exec alert=\"Info: Elevated activity from source IP ${src_ip}\" message=\"Source IP ${src_ip} has shown elevated levels of activity towards db-server. Current activity level is ${round((count/info_threshold),2)} times the baseline.\"",
      "reference": "index=* dest=db-server action=failure | stats count by src_ip, user | where count > 5",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.21568627450980393,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Detect potential brute force against db-server"
    },
    {
      "id": 11,
      "prediction": "index=* sourcetype=zeek:smb ProcessId=cmd.exe | table _time, Computer, CommandLine, StatusCode, ErrorMessage | sort -_time | head 20",
      "reference": "index=* sourcetype=zeek:smb ProcessId=cmd.exe",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.35294117647058826,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find ProcessId=cmd.exe in zeek:smb logs"
    },
    {
      "id": 12,
      "prediction": "index=zeek sourcetype=zeek_dns | eval query_ptr=\".\"+query | search query_ptr IN (*.example.com) | table _time id.orig_h query answers answers_ptr | stats count by query, answers_ptr | sort -count | head 20",
      "reference": "index=zeek sourcetype=zeek_dns qtype_name=\"PTR\" | table _time id.orig_h query answers",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show PTR reverse lookup queries"
    },
    {
      "id": 13,
      "prediction": "index=* sourcetype=zeek:dce_rpc | stats count by dest_ip | eventstats sum(count) as total | eval percentage=round((count/total)*100,2) | sort -count | head 20 | table _time, dest_ip, count, percentage",
      "reference": "index=* sourcetype=zeek:dce_rpc | stats count by dest_ip | eventstats sum(count) as total | eval percentage=round((count/total)*100,2)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.7428571428571429,
      "command_accuracy": 0.6666666666666666,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Group zeek:dce_rpc events by dest_ip and show percentages"
    },
    {
      "id": 14,
      "prediction": "index=* sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational | rare limit=20 action | table _time, Computer, Image, CommandLine, action, count | sort -count | head 15 | eval rare=if(match(action,\"(?i)admin\") AND match(Image,\"powershell.exe\"), \"yes\", \"no\") | where rare=\"yes\" | stats count by Computer, Image, CommandLine, action | sort -count | head 10",
      "reference": "index=* sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational | rare limit=20 action",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.35294117647058826,
      "command_accuracy": 0.25,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find rare action values in XmlWinEventLog:Microsoft-Windows-Sysmon/Operational"
    },
    {
      "id": 15,
      "prediction": "index=* sourcetype=\"zeek:http\" uri=*.vbs | stats count by src_ip, uri | where count > 5 | sort -count | head 10 | table _time, src_ip, uri, count | eval threshold=if(count>20, \"alert\", \"\") | where threshold=\"alert\" | table _time, src_ip, uri, count | info src_ip | alert alert.malware title=\"Possible VBS Download\" alert.severity=\"medium\" alert.description=\"Suspicious VBS download from %src_ip%\" alert.dest_port=\"80\" alert.uri=\"*.vbs\" alert.signature=\"VBS File\" | stats count avg(packets) max(packets) min(packets) by user, dest_ip | where packets<30 AND packets>10 | table _time, user, dest_ip, packets | eval threshold=if(packets>40, \"alert\", \"\") | where threshold=\"alert\" | table _time, user, dest_ip, packets | alert alert.malware title=\"Possible Execution of Downloaded VBS\" alert.severity=\"high\" alert.description=\"Executed VBS file on %dest_ip%\" alert.user=%user% | table _time, src_ip, dest_ip, user, packets | join [search index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 Image=\"*powershell.exe\"] | table _time, Computer, CommandLine | where match(CommandLine, \"(?i)(powershell|cmd|wscript)\\\\.exe\") | eval threshold=if(match(Image, \"(?i)(powershell|cmd|wscript)\\\\.exe\"), \"alert\", \"\") | where threshold=\"alert\" | table _time, Computer, CommandLine | alert alert.malware title=\"Execution of Suspected PowerShell or WScript Command\" alert.severity=\"high\" alert.description=\"Executed suspicious command on %Computer%\" alert.commandline=\"*(powershell|cmd|wscript)\\\\.exe*\" | table _time, src_ip, dest_ip, user, packets, Computer, CommandLine | save search malware_",
      "reference": "index=* sourcetype=zeek:http uri=*.vbs | stats count by src_ip, uri",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.16842105263157894,
      "command_accuracy": 0.2222222222222222,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Detect vbs file downloads"
    },
    {
      "id": 16,
      "prediction": "index=* malware earliest=-8h | table _time, src_ip, dest_ip, file | sort -_time | head 20",
      "reference": "index=* malware earliest=-8h",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.375,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Search for malware in the last 8h"
    },
    {
      "id": 17,
      "prediction": "index=* sourcetype=zeek:ntlm bytes=*administrator* | table _time, src_ip, dest_ip, user, command_line | stats count by _time, src_ip, dest_ip, user | sort -count | head 20",
      "reference": "index=* sourcetype=zeek:ntlm bytes=*administrator*",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.2857142857142857,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show me zeek:ntlm events where bytes contains administrator"
    },
    {
      "id": 18,
      "prediction": "index=* malware earliest=-1h | table _time, src_ip, dest_ip, alert.signature | sort -_time | head 20",
      "reference": "index=* \"malware\" earliest=-1h",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.25,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find all events containing the word 'malware' in the last hour"
    },
    {
      "id": 19,
      "prediction": "index=* | eval model_version=\"latest\" | stats values(model) as models by version, namespace | where isnotnull(models) | sort -len(models) | head 50 | table _time id.orig_h host user model model_version | more limit=20 | table _time id.orig_h host user model model_version",
      "reference": "| rest /services/datamodel/model | table title, eai:acl.app",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.125,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "List all datamodels in my environment."
    },
    {
      "id": 20,
      "prediction": "index=* sourcetype=zeek:ssl validation_status!=ok | table _time, src_ip, server_name, validation_status, error_message | sort -_time | head 10",
      "reference": "index=* sourcetype=zeek:ssl validation_status!=ok | table _time, src_ip, server_name, validation_status",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.6956521739130435,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show SSL certificate anomalies"
    },
    {
      "id": 21,
      "prediction": "index=* (failed OR failure) sourcetype=\"XmlWinEventLog:Security\" EventCode=4625 | stats count by src_ip, TargetUserName | where count > 10 AND count < 30 | sort -count | head 20 | table _time id.orig_h TargetUserName count | eval attempts=(count/2)| join [search index=* (successful OR success) sourcetype=\"XmlWinEventLog:Security\" EventCode=4625] | where TargetUserName IN (*) AND count<(attempts*2) | stats count as successful by id.resp_h, TargetUserName | where count>0 AND count<(attempts*2) | eval success_rate=(count/(attempts*2))| where success_rate>=0.8 | table _time id.orig_h TargetUserName count successful_rate | sort -success_rate | head 10",
      "reference": "index=* (EventCode=4625 OR \"failed password\" OR \"authentication failure\") | stats count dc(src_ip) as unique_ips by user | where count > 10 OR unique_ips > 5",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3225806451612903,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find potential brute force attacks against user accounts"
    },
    {
      "id": 22,
      "prediction": "index=* sourcetype=zeek:ssl | top limit=10 service | table _time, src_ip, server_name, bytes | sort -bytes | head 10",
      "reference": "index=* sourcetype=zeek:ssl | top limit=10 service",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5714285714285715,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show top 10 service from zeek:ssl"
    },
    {
      "id": 23,
      "prediction": "index=* sourcetype=zeek:ssl validation_status!=ok | table _time, src_ip, server_name, validation_status, error_message | sort -_time | head 10",
      "reference": "index=* sourcetype=zeek:ssl validation_status!=ok | table _time, src_ip, server_name, validation_status",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.6956521739130435,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show SSL certificate anomalies"
    },
    {
      "id": 24,
      "prediction": "index=* sourcetype=zeek:notice | timechart span=1h count | eventstats avg(count) as avg, stdev(count) as stdev | eval threshold=avg+(stdev*2) | where count > threshold | table _time, src_ip, dest_ip, alert.category, alert.severity",
      "reference": "index=* sourcetype=zeek:notice | timechart span=1h count | eventstats avg(count) as avg, stdev(count) as stdev | eval threshold=avg+(stdev*2) | where count > threshold",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.85,
      "command_accuracy": 0.888888888888889,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Identify zeek:notice anomalies using standard deviation"
    },
    {
      "id": 25,
      "prediction": "index=* sourcetype=zeek:ssh earliest=-4h | table _time, src_ip, dest_ip, command | sort -_time | head 20 | tail 10",
      "reference": "index=* sourcetype=zeek:ssh earliest=-4h",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.33333333333333337,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show zeek:ssh logs between 4h ago and now"
    },
    {
      "id": 26,
      "prediction": "index=* | eval full_name=concat(first_name, \" \", last_name)",
      "reference": "index=hr | eval full_name = first_name . \" \" . last_name",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.375,
      "command_accuracy": 1.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Concatenate the 'first_name' and 'last_name' fields into a 'full_name' field."
    },
    {
      "id": 27,
      "prediction": "index=zeek sourcetype=zeek_dns query=\"example.com\" | table _time id.orig_h host answer_name answers_txt | sort -_time | head 20",
      "reference": "index=zeek sourcetype=zeek_dns query=\"example.com\" | table _time id.orig_h query answers",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.6086956521739131,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show all DNS queries for a specific domain"
    },
    {
      "id": 28,
      "prediction": "index=* | stats count by dest_port | sort -count | head 20 | eval rank = _rank | where rank <= 5 | table _time, src_ip, dest_ip, dest_port, count",
      "reference": "index=* | stats count by dest_port | sort -count",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5333333333333333,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show dest_port values sorted by frequency"
    },
    {
      "id": 29,
      "prediction": "index=* | stats count by user_agent | sort -count | head 10 | table _time, src_ip, user_agent, count",
      "reference": "index=zeek sourcetype=zeek_http | stats count by user_agent | sort -count | head 10",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.7200000000000001,
      "command_accuracy": 0.8571428571428571,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "List top 10 user agents"
    },
    {
      "id": 30,
      "prediction": "index=* sourcetype=zeek:conn action=*root* | table _time, src_ip, dest_ip, action | stats count by _time, src_ip, dest_ip | sort -count | head 20",
      "reference": "index=* sourcetype=zeek:conn action=*root*",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show me zeek:conn events where action contains root"
    },
    {
      "id": 31,
      "prediction": "index=* sourcetype=zeek:dns | eval query_length=len(query) | where query_length > 50 | stats count avg(query_length) by src_ip, query | where count > 10 AND query IN (*google.com*) | sort -count | head 20 | table _time id.orig_h query count | rex field=\"id.orig_h\" \"([^.]+\\.[^.]+\\.[^.]+\\.){3}[^\\.]+\" | stats dc(id.orig_h) as unique_ips by query | where unique_ips > 5 | sort -unique_ips | head 10 | table _time query unique_ips | join [search index=* sourcetype=zeek:http | fields _time user uri] | where uri IN (*admin.php*) OR uri IN (*cmd.exe*) | table _time id.orig_h query unique_ips user uri | where NOT (user=\"root\") AND NOT (user=\"administrator\") | stats count by user, query, unique_ips | where count > 1 | sort -count | head 10 | table _time user query unique_ips | join [search index=* sourcetype=zeek:smb | fields _time server share path] | where path IN (\"*.txt\") OR path IN (\"*.doc\") | table _time id.orig_h query unique_ips user file | where NOT (file=\"readme.txt\") AND NOT (file=\"resume.doc\") | stats count by user, query, unique_ips | where count > 1 | sort -count | head 10 | table _time user query unique_ips | join [search index=* sourcetype=zeek:rdp | fields _time client host port session_name] | where session_name IN (*powershell.exe*) OR session_name IN (*command.exe*) | table _time id.orig_h query unique_ips user session_name | where NOT (session_name=\"calculator.exe\") AND NOT (session_name=\"notepad.exe\") | stats count by user, query, unique_ips | where count > 1 | sort -count | head 10 | table _time user query unique_ips | join [search",
      "reference": "index=* sourcetype=zeek:dns | eval query_length=len(query) | where query_length > 50 | stats count avg(query_length) by src_ip, query | where count > 10",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3720930232558139,
      "command_accuracy": 0.4615384615384615,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Identify DNS tunneling attempts"
    },
    {
      "id": 32,
      "prediction": "index=* sourcetype=zeek:files | timechart span=1h count | eventstats avg(count) as avg, stdev(count) as stdev | eval threshold=avg+(stdev*2) | where count > threshold | table _time, src_ip, dest_ip, file | stats count by user, host | where count > (avg*(1+0.5)) AND count < (avg*(1-0.5)) | sort -count | head 20 | info user, host | eval alert=\"File access anomaly\" | tag alert | table _time, src_ip, dest_ip, file, alert | table user, host, alert | stats count by user, host | where count > 3 | sort -count | head 10 | eval severity=if(count>6,\"critical\",\"warning\") | table user, host, alert, severity",
      "reference": "index=* sourcetype=zeek:files | timechart span=1h count | eventstats avg(count) as avg, stdev(count) as stdev | eval threshold=avg+(stdev*2) | where count > threshold",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.53125,
      "command_accuracy": 0.6666666666666666,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Identify zeek:files anomalies using standard deviation"
    },
    {
      "id": 33,
      "prediction": "index=* (dest_ip=\"10.10.10.25\" OR dest_ip=\"8.8.8.8\") | stats dc(dest_ip) as unique_dests values(dest_ip) by src_ip | where unique_dests=2 | sort -unique_dests | head 20 | table _time, src_ip, unique_dests[0], unique_dests[1] | eval combined_ips = strcat(unique_dests[0], \" \") + strcat(\"and\", \" \") + strcat(unique_dests[1]) | rex field=combined_ips search=\"([^ ]+)[ ]+(?<first_ip>[^ ]+)\" | rex field=combined_ips search=\"([^ ]+)$\" | eval second_ip=$1 | mvexpand first_ip second_ip | table _time, src_ip, first_ip, second_ip | join [search index=* dest_ip=\"$second_ip\"] | table _time, src_ip, first_ip, second_ip, dest_port, dest_host | where isnotnull(dest_port) AND isnotnull(dest_host) | stats count avg(packets) max(packets) min(packets) by src_ip, first_ip, second_ip | eval total_packets = sum(packets) | sort -total_packets | head 20 | table _time, src_ip, first_ip, second_ip, total_packets",
      "reference": "index=* (dest_ip=10.10.10.25 OR dest_ip=8.8.8.8) | stats dc(dest_ip) as unique_dests values(dest_ip) by src_ip | where unique_dests=2",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.32432432432432434,
      "command_accuracy": 0.3636363636363636,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find hosts communicating with both 10.10.10.25 and 8.8.8.8"
    },
    {
      "id": 34,
      "prediction": "index=firewall | stats count by src_ip, dest_port | sort -count | head 10 | table _time id.orig_h id.resp_p count | rex field=\"id.orig_h\" as orig_ip | rex field=\"id.resp_p\" as resp_port | eval combination=\"$orig_ip-$resp_port\" | table combination, count",
      "reference": "index=firewall | rex field=_raw \"SRC=(?<src_ip>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) DPT=(?<dest_port>\\d+)\" | stats count by src_ip, dest_port | sort -count | head 10",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.6153846153846154,
      "command_accuracy": 0.8,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "From my firewall logs, extract the source IP and destination port, and show me the top 10 most frequent combinations."
    },
    {
      "id": 35,
      "prediction": "index=* sourcetype=zeek:conn | bin _time span=1h | stats count by _time, src_ip, dest_ip | eventstats avg(count) as avg_count by src_ip, dest_ip | where count > (avg_count * 0.8) AND count < (avg_count * 1.2) | eval score = if(count >= (avg_count * 0.9), 1, 0) | where score == 1 AND src_ip != dest_ip | table _time, src_ip, dest_ip, count, score",
      "reference": "index=* sourcetype=zeek:conn | bin _time span=1h | stats count by _time, src_ip, dest_ip | eventstats avg(count) as avg_count by src_ip, dest_ip | where count > (avg_count * 0.8) AND count < (avg_count * 1.2)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.761904761904762,
      "command_accuracy": 0.7499999999999999,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find beaconing behavior in network connections"
    },
    {
      "id": 36,
      "prediction": "index=* sourcetype=zeek:notice duration=encoded | table _time, src_ip, dest_ip, action | stats count by user | sort -count | head 10 | eval percentage=round((count/sum(count))*100,2) | eval total=sum(count) | where count>5 | format _time, src_ip, dest_ip, action, percentage, total | table _time, src_ip, dest_ip, action, percentage, total | more limit=20 | less limit=10 | search index=* sourcetype=zeek:notice duration=encoded | table _time, src_ip, dest_ip, action | stats count by user | sort -count | head 10 | eval percentage=round((count/sum(count))*100,2) | eval total=sum(count) | where count<5 | format _time, src_ip, dest_ip, action, percentage, total | table _time, src_ip, dest_ip, action, percentage, total | join [search] [eval] using user | eval combined_percentage=round(([search].count+[eval].count)/total*100,2) | format _time, src_ip, dest_ip, action, percentage_[search], percentage_[eval], combined_percentage | table _time, src_ip, dest_ip, action, percentage_[search], percentage_[eval], combined_percentage",
      "reference": "index=* sourcetype=zeek:notice duration=encoded",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.13953488372093023,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find duration=encoded in zeek:notice logs"
    },
    {
      "id": 37,
      "prediction": "index=* sourcetype=\"zeek:conn\" | bin _time span=1h | stats count as connections_per_hour, dc(src_ip) as unique_senders, dc(dest_ip) as unique_receivers | where connections_per_hour > 5 AND unique_senders < 20 AND unique_receivers < 20 | eval avg_interval = (connections_per_hour * 3600) / (unique_senders + unique_receivers) | where avg_interval > 4h OR avg_interval < 1h | info src_ip, dest_ip, connections_per_hour, unique_senders, unique_receivers, avg_interval | table _time id.orig_h host user service action status duration | join [search index=* sourcetype=\"zeek:conn\"] | where _time IN (*connection*) AND (_time - prev(_time)) <= (avg_interval * 0.9) AND (_time - prev(_time)) >= (avg_interval * 0.1) | stats count as matches_in_window, values(id.resp_h) as responder_ips by id.orig_h, id.resp_h | where matches_in_window > 10 AND responder_ips != \"\" | sort -matches_in_window | head 10 | table id.orig_h, responder_ips, matches_in_window | eval total_beacons = sum(matches_in_window) | where total_beacons > 5 | table id.orig_h, responder_ips, total_beacons",
      "reference": "sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=3 | bucket _time span=5m | stats count by _time, Computer, Image, DestinationIp | stats dc(_time) as time_intervals, count as total_connections by Computer, Image, DestinationIp | where time_intervals>50 AND total_connections>100",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.16494845360824742,
      "command_accuracy": 0.36363636363636365,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Detect beaconing behavior by analyzing connection intervals"
    },
    {
      "id": 38,
      "prediction": "index=* (dest_ip=\"1.1.1.1\" OR dest_ip=\"192.168.1.50\") | stats dc(dest_ip) as unique_dests, values(dest_ip) as dests by src_ip | where unique_dests=2 | sort -unique_dests | head 20 | table _time id.orig_h host1 host2 | eval common_ips=if(match(host1,\"^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$\"), match(host2,\"^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$\") AND match(host1,\"^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$\")!=match(host2,\"^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$\"), \"\", host1, host2) | where isnotnull(common_ips) | table _time id.orig_h common_ips | rex field=common_ips \"(\\d{1,3}\\.){3}\\d+\" as ip1, \"(\\d{1,3}\\.){3}\\d+\" as ip2 | table _time id.orig_h ip1 ip2",
      "reference": "index=* (dest_ip=1.1.1.1 OR dest_ip=192.168.1.50) | stats dc(dest_ip) as unique_dests values(dest_ip) by src_ip | where unique_dests=2",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.40740740740740744,
      "command_accuracy": 0.4444444444444445,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find hosts communicating with both 1.1.1.1 and 192.168.1.50"
    },
    {
      "id": 39,
      "prediction": "index=* sourcetype=zeek:ssh | rare limit=20 src_ip | table _time, src_ip, count | sort -count | head 10 | eval rare=if(count<3, \"yes\", \"no\") | where rare=\"yes\" | stats count by src_ip, user | sort -count | head 5 | table _time, src_ip, user, count",
      "reference": "index=* sourcetype=zeek:ssh | rare limit=20 src_ip",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3870967741935484,
      "command_accuracy": 0.25,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find rare src_ip values in zeek:ssh"
    },
    {
      "id": 40,
      "prediction": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 | eval dll_download=if(match(File, \"(?i)dll\") AND match(DestinationPath, \"(?i)(?:\\\\temp|%TEMP%)\"), 1, 0) | where dll_download=1 | stats count by src_ip, DestinationIp, File, User | sort -count | head 25 | table _time id.orig_h dest_ip user file | rex field=file \"(\\w+)\\.(dll)$\" | table _time id.orig_h dest_ip user group(group(Match)) as package | sort -count | head 10 | table _time id.orig_h dest_ip user package | join [search index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=3] | where Image contains (package) | table _time id.orig_h dest_ip user package Image | stats dc(Image) as unique_processes, values(Image) as processes by user, package | sort -unique_processes | head 10 | table _time id.orig_h dest_ip user package unique_processes | eval total_processes=len(unique_processes) | eval avg_processes=(total_processes)/(count) | eval percentage_executed=(avg_processes)*100 | eval percentage_not_executed=(1-(percentage_executed))*100 | table _time id.orig_h dest_ip user package unique_processes percentage_executed percentage_not_executed",
      "reference": "index=* sourcetype=zeek:http uri=*.dll | stats count by src_ip, uri",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.18461538461538463,
      "command_accuracy": 0.19999999999999998,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Detect dll file downloads"
    },
    {
      "id": 41,
      "prediction": "index=* src_ip=\"192.168.1.50\" | table _time, src_ip, dest_ip, dest_port, event_type, message | sort -_time | paginate 25 | stats count by user, dest_ip, dest_port | where count > 30 | eval threshold=(count/25)*100 | where threshold < 70 | search index=* (action=success OR action=failure) | table _time, src_ip, dest_ip, dest_port, event_type, message | sort -_time | head 20 | info host | tail 10 | more | less | clear | save | reload | exit",
      "reference": "index=* src_ip=192.168.1.50",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.04444444444444444,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Display all logs from source IP 192.168.1.50"
    },
    {
      "id": 42,
      "prediction": "index=* sourcetype=zeek:conn proto=icmp dest_port=8080 | table _time id.orig_h host user service action status | sort -status | head 20 | tail 15 | eval total=sum(action) as total | where action=\"ESTABLISHED\" OR action=\"REPLIES\" | stats count avg(total) by src_ip, dest_ip | sort -count | head 10 | eval percentage=round((count/sum(count))*100,2) as percentage | format percentage \"%\" | rex field=percentage \"^([\\d]+)\\%$\" percentage | eval percentage=regex_replace(percentage,\"^\\d+\",\"\") as percentage | eval percentage=strcat(\"(\",percentage,\")\",\",\") | eval percentage=eval(percentage) | eval percentage=format(\"%s%%\",percentage) | eval percentage=eval(percentage) | eval percentage=strcat(\"[\",percentage,\"]\") | eval percentage=eval(percentage) | eval percentage=format(\"%s]\",percentage) | eval percentage=eval(percentage) | eval percentage=strcat(\"% \",percentage) | eval percentage=eval(percentage) | eval percentage=format(\"%s\",percentage) | eval percentage=eval(percentage) | eval percentage=strcat(\"% \",percentage) | eval percentage=eval(percentage) | eval percentage=format(\"%s]\",percentage) | eval percentage=eval(percentage) | eval percentage=strcat(\"% \",percentage) | eval percentage=eval(percentage) | eval percentage=format(\"%s\",percentage) | eval percentage=eval(percentage) | eval percentage=strcat(\"% \",percentage) | eval percentage=eval(percentage) | eval percentage=format(\"%s]\",percentage) | eval percentage=eval(percentage) | eval percentage=strcat(\"% \",percentage) | eval percentage=eval(percentage) | eval percentage=format(\"%s\",percentage) | eval percentage=eval(percentage) | eval percentage=strcat(\"% \",percentage) | eval percentage=eval(percentage) | eval percentage=format(\"%s]\",percentage) | eval percentage=eval(percentage) | eval percentage=strcat(\"% \",percentage) | eval percentage=eval(percentage)",
      "reference": "index=* sourcetype=zeek:conn proto=icmp dest_port=8080 | table _time, src_ip, dest_ip, bytes",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.2295081967213115,
      "command_accuracy": 0.2222222222222222,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show all icmp connections to port 8080"
    },
    {
      "id": 43,
      "prediction": "index=zeek sourcetype=zeek_dns | stats dc(query) as unique_queries, values(query) by query | where unique_querries > 0 | sort -unique_querries | head 25 | table _time id.orig_h query answers ns_count nxdomain_count | eval query_type = if(match(query,\"^(?:[A-Za-z]+|\\\\*)\") AND match(query,\"^(?:[A-Fa-f]{4}|[A-Fa-f]{8}$)\"), \"Other\", query_type) | rename query_type as query_type_short | sort -query_type_short | table * | more limit=100",
      "reference": "index=zeek sourcetype=zeek_dns | stats count by qtype_name | sort -count",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.25531914893617025,
      "command_accuracy": 0.4444444444444445,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "List all unique DNS query types"
    },
    {
      "id": 44,
      "prediction": "index=* sourcetype=XmlWinEventLog:Security | stats count by bytes | eventstats sum(count) as total | eval percentage=round((count/total)*100,2) | sort -count | head 50 | table _time, src_ip, dest_ip, EventCode, EventType, EventCategory, EventSubcategory, EventDescription, count, percentage",
      "reference": "index=* sourcetype=XmlWinEventLog:Security | stats count by bytes | eventstats sum(count) as total | eval percentage=round((count/total)*100,2)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.6341463414634146,
      "command_accuracy": 0.6666666666666666,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Group XmlWinEventLog:Security events by bytes and show percentages"
    },
    {
      "id": 45,
      "prediction": "index=* sourcetype=zeek:ssh earliest=-30d | table _time, src_ip, dest_ip, command | sort -_time | head 20 | tail 20",
      "reference": "index=* sourcetype=zeek:ssh earliest=-30d",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.35294117647058826,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show zeek:ssh logs between 30d ago and now"
    },
    {
      "id": 46,
      "prediction": "index=* dest_port=443 | table _time, src_ip, dest_ip, event_type, alert.signature | more limit=20",
      "reference": "index=* dest_port=443",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3076923076923077,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find all events with destination port 443"
    },
    {
      "id": 47,
      "prediction": "index=* logon | failure | src_ip=\"10.10.10.25\" | stats count by user, src_ip | sort -count | head 10 | table _time id.orig_h host user count | where count > 30 | eval thresholded=(if(count>40,\"FAILED\", \"OK\")) | rex field=_time \"^(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2})$\") | eval date=$1 | eval time=$2 | eval timestamp=\"$date $time\" | stats count avg(count) as average by thresholded | where count<average AND thresholded=\"FAILED\" | table timestamp user src_ip count thresholded | sort -timestamp | head 10",
      "reference": "index=* logon=failed src_ip=10.10.10.25 | stats count by user, src_ip",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.2745098039215686,
      "command_accuracy": 0.25,
      "syntax_valid": false,
      "clarification_match": 1.0,
      "instruction": "Find failed logon attempts from 10.10.10.25"
    },
    {
      "id": 48,
      "prediction": "index=* | stats dc(dest_ip) as unique_ips, values(dest_ip) as dest_ips by src_ip | sort -unique_ips | head 10 | eval avg_uniq_ips = round((unique_ips/src_count)*100,2) | rex field=\"dest_ips\" \"(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})+\" | table _time id.orig_h id.resp_h unique_ips avg_uniq_ips",
      "reference": "index=zeek sourcetype=zeek_conn | stats dc(id.resp_h) as unique_destinations by id.orig_h | where unique_destinations>50 | sort -unique_destinations",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.30769230769230776,
      "command_accuracy": 0.4444444444444444,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Count unique destination IPs contacted by each source"
    },
    {
      "id": 49,
      "prediction": "index=* sourcetype=zeek:http earliest=-4h | table _time, src_ip, user, uri, status, bytes | sort -_time | head 20",
      "reference": "index=* sourcetype=zeek:http earliest=-4h",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.33333333333333337,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show me all zeek:http logs from the last 4h"
    },
    {
      "id": 50,
      "prediction": "index=* host=workstation-01 | table _time, src_ip, dest_ip, event_type, alert.signature | sort -_time | head 20",
      "reference": "index=* host=workstation-01",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.2666666666666667,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get all events from host workstation-01"
    },
    {
      "id": 51,
      "prediction": "index=* (dest_ip=\"192.168.1.100\" OR dest_ip=\"172.16.5.10\") | stats dc(dest_ip) as unique_dests values(dest_ip) by src_ip | where unique_dests=2 | sort -unique_dests | head 20 | table _time, src_ip, unique_dests[0], unique_dests[1] | eval combined_ips = strcat(unique_dests[0], \" \") + strcat(unique_dests[1], \" \") | rex field=combined_ips regex=\"([^ ]+ )+(?<host>[^ ]+)\" | table _time, host, unique_dests[0], unique_dests[1]",
      "reference": "index=* (dest_ip=192.168.1.100 OR dest_ip=172.16.5.10) | stats dc(dest_ip) as unique_dests values(dest_ip) by src_ip | where unique_dests=2",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.46153846153846156,
      "command_accuracy": 0.4444444444444445,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find hosts communicating with both 192.168.1.100 and 172.16.5.10"
    },
    {
      "id": 52,
      "prediction": "index=* sourcetype=zeek:notice | top limit=10 duration | table _time, src_ip, dest_ip, duration",
      "reference": "index=* sourcetype=zeek:notice | top limit=10 duration",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.7499999999999999,
      "command_accuracy": 0.6666666666666666,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show top 10 duration from zeek:notice"
    },
    {
      "id": 53,
      "prediction": "index=zeek sourcetype=zeek_http uri=\"/*admin*\" | table _time id.orig_h host uri method status response_body | stats count by _time, id.orig_h, host, uri, method, status | where status>=200 AND status<=399 | sort -count | head 15",
      "reference": "index=zeek sourcetype=zeek_http uri=\"*/admin*\" | table _time id.orig_h host uri method",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.4736842105263158,
      "command_accuracy": 0.33333333333333337,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show all requests to admin paths"
    },
    {
      "id": 54,
      "prediction": "index=* sourcetype=splunk_forwarder | eval last_hour_ago=now-1h | where isnotnull(last_hour_ago) AND (eventcount<1 OR eventcount IS NULL) | stats count by host, src_ip | where count==0 | sort -count | head 25 | table _time, host, src_ip, eventcount | rex field=_time \"(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2})\" as timestamp | eval status=\"ok\" WHERE eventcount>0 ELSE \"warning\" END AS alert_status | eval severity=\"info\" | mvexpand alert_status, severity | table timestamp, host, src_ip, alert_status, severity",
      "reference": "| metadata type=hosts index=* | where lastTime < relative_time(now(), \"-1h\")",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.11538461538461539,
      "command_accuracy": 0.25,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "List Splunk forwarders that have not sent any data in the last hour."
    },
    {
      "id": 55,
      "prediction": "index=* sourcetype=zeek:conn proto=udp | table _time, src_ip, dest_ip, bytes | sort -bytes | head 20 | stats count avg(bytes) by src_ip, dest_ip | where count > 5 | eval total = sum(bytes) | sort -total | head 10 | table _time, src_ip, dest_ip, bytes, total | eval percentage = round((bytes/total)*100,2) | format percentage as \"%.2f%%\" | table _time, src_ip, dest_ip, bytes, total, percentage",
      "reference": "index=* sourcetype=zeek:conn proto=udp",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.1621621621621622,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get all udp traffic logs"
    },
    {
      "id": 56,
      "prediction": "index=* | stats count avg(resp_bytes) max(resp_bytes) min(resp_bytes) by answers | sort -count | head 10 | eval avg_rounded = round(avg(resp_bytes),2) | eval max_rounded = round(max(resp_bytes),2) | eval min_rounded = round(min(resp_bytes),2) | table _time, answers, count, avg_rounded, max_rounded, min_rounded",
      "reference": "index=* | stats count avg(resp_bytes) max(resp_bytes) min(resp_bytes) by answers",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5,
      "command_accuracy": 0.33333333333333337,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get statistics of resp_bytes grouped by answers"
    },
    {
      "id": 57,
      "prediction": "index=* | stats dc(Image) as unique_count by LogonType | sort -unique_count | head 10 | table _time, LogonType, unique_count, Images[] | more limit=20 | eval total=sum(unique_count) | info total | where LogonType=\"Remote\" | stats avg(unique_count) as avg_remote by ParentImage | where LogonType=\"Local\" | stats avg(unique_count) as avg_local | where LogonType=\"Service\" | stats avg(unique_count) as avg_service | where LogonType=\"Admin\" | stats avg(unique_count) as avg_admin | where LogonType=\"System\" | stats avg(unique_count) as avg_system | where LogonType=\"Network\" | stats avg(unique_count) as avg_network | where LogonType=\"Authentication\" | stats avg(unique_count) as avg_authentication | where LogonType=\"Encryption\" | stats avg(unique_count) as avg_encryption | where LogonType=\"Compression\" | stats avg(unique_count) as avg_compression | where LogonType=\"Cryptography\" | stats avg(unique_count) as avg_cryptography | where LogonType=\"Security\" | stats avg(unique_count) as avg_security | where LogonType=\"FileAccess\" | stats avg(unique_count) as avg_fileaccess | where LogonType=\"RegistryAccess\" | stats avg(unique_count) as avg_registryaccess | where LogonType=\"ProcessCreation\" | stats avg(unique_count) as avg_processcreation | where LogonType=\"EventLogging\" | stats avg(unique_count) as avg_eventlogging | where LogonType=\"Firewall\" | stats avg(unique_count) as avg_firewall | where LogonType=\"DNSResolution\" | stats avg(unique_count) as avg_dnsresolution | where LogonType=\"CertificateValidation\" | stats avg(unique_count) as avg_certificatevalidation | where LogonType=\"SMBCommunication\" | stats avg(unique_count)",
      "reference": "index=* | stats dc(Image) as unique_count by LogonType",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.22535211267605632,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find unique Image count by LogonType"
    },
    {
      "id": 58,
      "prediction": "index=* sourcetype=zeek:dce_rpc | stats count by uri | eventstats sum(count) as total | eval percentage=round((count/total)*100,2) | sort -count | head 20 | table _time, uri, count, percentage",
      "reference": "index=* sourcetype=zeek:dce_rpc | stats count by uri | eventstats sum(count) as total | eval percentage=round((count/total)*100,2)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.7428571428571429,
      "command_accuracy": 0.6666666666666666,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Group zeek:dce_rpc events by uri and show percentages"
    },
    {
      "id": 59,
      "prediction": "index=* failure earliest=-30d | table _time, src_ip, dest_ip, query, status | sort -_time | head 20 | more limit=10 | tail limit=10",
      "reference": "index=* failure earliest=-30d",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Search for failure in the last 30d"
    },
    {
      "id": 60,
      "prediction": "index=* sourcetype=zeek:ssh Computer=*cmd.exe* | table _time, src_ip, dest_ip, CommandLine | sort -_time | head 20",
      "reference": "index=* sourcetype=zeek:ssh Computer=*cmd.exe*",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.375,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show me zeek:ssh events where Computer contains cmd.exe"
    },
    {
      "id": 61,
      "prediction": "index=* | stats count avg(packets) max(packets) min(packets) by Computer | sort -count | head 20 | eval avg_rounded = round(avg(packets),-1) | eval max_rounded = round(max(packets),-1) | eval min_rounded = round(min(packets),-1) | table _time, Computer, count, avg_rounded, max_rounded, min_rounded",
      "reference": "index=* | stats count avg(packets) max(packets) min(packets) by Computer",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5,
      "command_accuracy": 0.33333333333333337,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get statistics of packets grouped by Computer"
    },
    {
      "id": 62,
      "prediction": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 ParentImage=*winword.exe* | table _time, Computer, Image, CommandLine | sort -_time | head 20",
      "reference": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 ParentImage=*winword.exe* | table _time, Computer, Image, CommandLine",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.8333333333333333,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find processes created by winword.exe"
    },
    {
      "id": 63,
      "prediction": "index=* ProcessId=* | where isnotnull(ProcessId) | table _time, Computer, User, ProcessId, CommandLine | sort -_time | head 20",
      "reference": "index=* ProcessId=* | where isnotnull(ProcessId)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find events where ProcessId is not null"
    },
    {
      "id": 64,
      "prediction": "index=zeek sourcetype=zeek_conn | table _time id.orig_h host port service action status | where action IN (*ESTABLISHED*) | sort -_time | head 20 | stats count by user, src_port, dest_ip, dest_port | eval total=count | where count>10 | sort -total | head 50 | table * | more limit=30 | tail limit=30",
      "reference": "sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=3 Protocol=tcp Initiated=true | table _time Computer Image DestinationIp DestinationPort",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.13333333333333333,
      "command_accuracy": 0.25,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Display all initiated TCP connections"
    },
    {
      "id": 65,
      "prediction": "index=zeek sourcetype=zeek_conn id.resp_h=\"10.0.5.20\" | table _time, id.orig_h, id.resp_p, bytes | sort -bytes | head 30 | stats count avg(bytes) by id.orig_h | eval avg_bytes = round((avg(bytes)/1048576),2) | where bytes > (avg_bytes*90) AND bytes < (avg_bytes*110) | eval percent = ((bytes-avg_bytes)*100/avg_bytes)| sort -percent | head 10 | eval total_packets = sum(packets) as packets | eval total_bytes = sum(bytes) as bytes | info | table _time, id.orig_h, id.resp_h, packets, bytes, percent, total_packets, total_bytes",
      "reference": "sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=3 DestinationIp=\"203.0.113.100\" | table _time Computer Image User DestinationPort",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.07407407407407407,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Display connections to a specific IP address"
    },
    {
      "id": 66,
      "prediction": "index=* sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational | timechart span=1h count | eventstats avg(count) as avg, stdev(count) as stdev | eval threshold=avg+(stdev*2) | where count > threshold | table _time, src_ip, dest_ip, command_line | sort -count | head 20 | stats count by user, Image | where count < (avg*(0.8)) OR count > (avg*(1.2)) | sort -count | head 5 | table _time, user, Image, count",
      "reference": "index=* sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational | timechart span=1h count | eventstats avg(count) as avg, stdev(count) as stdev | eval threshold=avg+(stdev*2) | where count > threshold",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.6415094339622641,
      "command_accuracy": 0.6666666666666666,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Identify XmlWinEventLog:Microsoft-Windows-Sysmon/Operational anomalies using standard deviation"
    },
    {
      "id": 67,
      "prediction": "index=zeek sourcetype=zeek_dns rtype=\"TXT\" | table _time id.orig_h query answers | stats count by id.orig_h, query, answers | sort -count | head 20",
      "reference": "index=zeek sourcetype=zeek_dns qtype_name=\"TXT\" | table _time id.orig_h query answers",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5925925925925926,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find all TXT record queries"
    },
    {
      "id": 68,
      "prediction": "index=* | stats avg(packets) by action | sort -avg_packets | head 20 | eval rank = _rank | where rank <= 5 | table action, avg_packets, rank",
      "reference": "index=* | stats avg(packets) by action",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.4615384615384615,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Calculate average packets per action"
    },
    {
      "id": 69,
      "prediction": "index=* sourcetype=zeek:http earliest=-24h | table _time, src_ip, user, uri, status, bytes | sort -_time | head 50 | tail 50",
      "reference": "index=* sourcetype=zeek:http earliest=-24h",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3157894736842105,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show me all zeek:http logs from the last 24h"
    },
    {
      "id": 70,
      "prediction": "index=* | stats count by dest_ip | sort -count | head 20 | eval rank=if(match(dest_ip, \"(?i)admin\") AND match(dest_ip, \"(?i)root\"), 1, 0) | where rank>0 | eval score=(rank)*(-log(count/sum(count))) | sort -score | head 5 | eval total_score=round((-log(count/sum(count))),3) | table _time id.orig_h dest_ip count rank score total_score",
      "reference": "index=* | stats count by dest_ip | sort -count",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.4210526315789474,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show dest_ip values sorted by frequency"
    },
    {
      "id": 71,
      "prediction": "index=* sourcetype=\"XmlWinEventLog:Security\" EventCode=4625 | stats count by src_ip, TargetUserName | sort -count | head 10 | table _time, src_ip, TargetUserName, Count | eval failure_rate = round((Count / (Count + Count(eval Success=true))) * 100, 2) | where failure_rate > 50 | format _time, \"yyyy-MM-dd HH:mm:ss.SSS\" | rex field=_time \"^(\\d{4})-(\\d{2})-(\\d{2}) (\\d{2}):(\\d{2}):(\\d{2})\\.\\d+\" | eval date=_3, time=_4, hour=_5, minute=_6 | table date, time, hour, minute, failure_rate, TargetUserName",
      "reference": "index=* sourcetype=\"XmlWinEventLog:Security\" EventCode=4625 | stats count by src_ip, TargetUserName",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.32142857142857145,
      "command_accuracy": 0.25,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show failed Windows authentication attempts"
    },
    {
      "id": 72,
      "prediction": "index=* sourcetype=zeek:software | timechart span=1h count | eventstats avg(count) as avg, stdev(count) as stdev | eval threshold=avg+(stdev*2) | where count > threshold | info _time id.orig_h host command_line | table _time id.orig_h host command_line count | sort -_time | head 7d",
      "reference": "index=* sourcetype=zeek:software | timechart span=1h count",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3636363636363636,
      "command_accuracy": 0.25,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show zeek:software events over time in 1h intervals"
    },
    {
      "id": 73,
      "prediction": "index=* proto=* | where isnotnull(proto) | table _time, src_ip, dest_ip, proto, data | sort -_time | head 20",
      "reference": "index=* proto=* | where isnotnull(proto)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find events where proto is not null"
    },
    {
      "id": 74,
      "prediction": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 | eval escalation_attempt=if(match(TargetUserName, \"(admin|root)\") AND match(ParentImage, \"(powershell|cmd|wscript)\\\\.exe\"), 1, 0) | where escalation_attempt=1 | table _time Computer TargetUserName ParentImage CommandLine | stats count by Computer, TargetUserName, ParentImage, CommandLine | sort -count | head 20",
      "reference": "index=windows (EventCode=4672 OR EventCode=4673 OR EventCode=4674) Privileges=\"*SeDebugPrivilege*\" | stats count by user, host",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.19047619047619044,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find privilege escalation attempts"
    },
    {
      "id": 75,
      "prediction": "index=* failed earliest=-4h | search index=* | table _time, src_ip, dest_ip, query, status | sort -_time | head 20",
      "reference": "index=* failed earliest=-4h",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.33333333333333337,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Search for failed in the last 4h"
    },
    {
      "id": 76,
      "prediction": "index=* sourcetype=zeek:conn | stats count by proto | eventstats sum(count) as total | eval percentage=round((count/total)*100,2) | sort -count | head 15 | table _time, proto, count, percentage",
      "reference": "index=* sourcetype=zeek:conn | stats count by proto | eventstats sum(count) as total | eval percentage=round((count/total)*100,2)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.7428571428571429,
      "command_accuracy": 0.6666666666666666,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Group zeek:conn events by proto and show percentages"
    },
    {
      "id": 77,
      "prediction": "index=* | show top 10 query by event count, duration and error rate | sort -event_count,-duration,-error_rate | table _time id.orig_h host user query duration status error_rate | where (status <> 200) OR (error_rate > 5%) | eval total_issues = if(match(query,\"SELECT * FROM users\") AND match(query,\"WHERE age IS NOT NULL\"), 1, 0) | where total_issues > 0 | stats count avg(duration) max(duration) min(duration) by user, query | eval average_response_time = round((avg(duration)+max(duration))/2,2) | eval response_variance = round(((max(duration)-min(duration))/(avg(duration)+max(database,min(database)))),2) | eval issue_severity = case(total_issues=\"1\", \"Low\", total_issues=\"3\", \"Medium\", total_issues=\"5\", \"High\") end | table _time id.orig_h host user query average_response_time response_variance issue_severity",
      "reference": "CLARIFICATION: For performance analysis, I need:\n- Which system or application?\n- What metrics (CPU, memory, disk I/O, response time, latency)?\n- What defines 'issue' (threshold or percentage)?\n- Time range to analyze?\n- Comparing to baseline or absolute values?",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.021052631578947368,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 0.0,
      "instruction": "Show me performance issues"
    },
    {
      "id": 78,
      "prediction": "index=* sourcetype=XmlWinEventLog:Security earliest=-30d | table _time, Computer, Image, CommandLine, EventCode, EventType, LogonType, ParentImage | sort -_time | head 50 | tail 50",
      "reference": "index=* sourcetype=XmlWinEventLog:Security earliest=-30d",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.2857142857142857,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show me all XmlWinEventLog:Security logs from the last 30d"
    },
    {
      "id": 79,
      "prediction": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 ParentImage=*services.exe* | table _time, Computer, Image, CommandLine | sort -_time | head 20",
      "reference": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 ParentImage=*services.exe* | table _time, Computer, Image, CommandLine",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.8333333333333333,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find processes created by services.exe"
    },
    {
      "id": 80,
      "prediction": "index=* | stats count avg(orig_bytes) max(orig_bytes) min(orig_bytes) by dest_ip | sort -count | head 10 | eval total=sum(avg(orig_bytes)) | eval average=round((total/10),2) | table _time, dest_ip, count, avg, max, min, average",
      "reference": "index=* | stats count avg(orig_bytes) max(orig_bytes) min(orig_bytes) by dest_ip",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5454545454545454,
      "command_accuracy": 0.33333333333333337,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get statistics of orig_bytes grouped by dest_ip"
    },
    {
      "id": 81,
      "prediction": "index=* | transaction user startswith=\"action\" endswith=\"complete\" | eval total_actions = count by user, _time | sort -total_actions | head 20 | streamstats window=1d sum(total_actions) as daily_activity by user | join [search index=* action OR search index=* complete] | table user, daily_activity[start], daily_activity[end], daily_activity[sum] | foreach i in * | rendersparkline \"eval(i)\" width=50 height=30 color=blue linecolor=red | append to_csv /path/to/output.csv | stats count avg(daily_activity[sum]) max(daily_activity[sum]) min(daily_activity[sum]) by user | info user, count, avg(daily_activity[sum]), max(daily_activity[sum]), min(daily_activity[sum])",
      "reference": "index=_audit user!=splunk-system-user earliest=-7d | timechart count by user | addsparkline",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.12903225806451613,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show a table of users and a sparkline of their activity over the last 7 days."
    },
    {
      "id": 82,
      "prediction": "index=* | rare limit=5 dest_ip | table _time, src_ip, dest_ip, event_count | sort -event_count | head",
      "reference": "index=* | rare limit=5 dest_ip",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5555555555555556,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show bottom 5 dest_ip by event count"
    },
    {
      "id": 83,
      "prediction": "index=* sourcetype=zeek:dns | eval query_length=len(query) | where query_length > 50 | stats count avg(query_length) by src_ip, query | where count > 10 AND query IN (*google.com*) | sort -count | head 20 | table _time id.orig_h query count | rex field=\"id.orig_h\" \"([^.]+\\.[^.]+\\.[^.]+\\.){3}[^\\.]+\" | stats dc(id.orig_h) as unique_ips by query | where unique_ips > 5 | sort -unique_ips | head 10 | table _time query unique_ips | join [search index=* sourcetype=zeek:http | fields _time id.orig_h uri] | where uri IN (*admin*) OR uri IN (*command*) | table _time id.orig_h query uri | join [search index=* sourcetype=zeek:smb | fields _time id.orig_h path user] | where path IN (\"*\\*.exe\") OR path IN (\"*\\*.scr\") | table _time id.orig_h query uri user | join [search index=* sourcetype=zeek:rdp | fields _time id.orig_h session_id] | where session_id NOT NULL | table _time id.orig_h query uri user session_id | join [search index=* sourcetype=zeek:pe | fields _time id.orig_h command_line] | where command_line IN (*powershell.exe*) OR command_line IN (*cmd.exe*) | table _time id.orig_h query uri user session_id command_line | join [search index=* sourcetype=zeek:conn | fields _time id.resp_h service] | where service IN (*ssh*) OR service IN (*https*) | table _time id.orig_h query uri user session_id command_line id.resp_h service | join [search index=* sourcetype=zeek:filesystem | fields _time id.orig_h file_name] | where file_name IN (*encrypted*) OR file_name IN (*encoded*) | table _time id.orig_",
      "reference": "index=* sourcetype=zeek:dns | eval query_length=len(query) | where query_length > 50 | stats count avg(query_length) by src_ip, query | where count > 10",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.36781609195402304,
      "command_accuracy": 0.4615384615384615,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Identify DNS tunneling attempts"
    },
    {
      "id": 84,
      "prediction": "index=* sourcetype=zeek:conn | bin _time span=1h | stats count by _time, src_ip, dest_ip | eventstats avg(count) as avg_count by src_ip, dest_ip | where count > (avg_count * 0.8) AND count < (avg_count * 1.2) | eval score = if(count >= (avg_count * 0.9), 1, 0) | where score == 1 AND src_ip != dest_ip | table _time, src_ip, dest_ip, count, score",
      "reference": "index=* sourcetype=zeek:conn | bin _time span=1h | stats count by _time, src_ip, dest_ip | eventstats avg(count) as avg_count by src_ip, dest_ip | where count > (avg_count * 0.8) AND count < (avg_count * 1.2)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.761904761904762,
      "command_accuracy": 0.7499999999999999,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find beaconing behavior in network connections"
    },
    {
      "id": 85,
      "prediction": "index=* host=email-gateway | table _time, src_ip, dest_ip, event_type, alert.signature | sort -_time | streamstats count by alert.signature | where count > 50 | stats avg(count) as avg_count by alert.signature | eval threshold = if(avg_count < 10, \"LOW\", \"HIGH\") | where threshold=\"HIGH\" | table _time, src_ip, dest_ip, alert.signature, count, avg_count, threshold | sort -_time",
      "reference": "index=* host=email-gateway",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.1142857142857143,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get all events from host email-gateway"
    },
    {
      "id": 86,
      "prediction": "index=* sourcetype=zeek:ssl | timechart span=1m count | streamstats window=30 avg(count) as avg, max(count) as max, min(count) as min | table _time, count, avg, max, min",
      "reference": "index=* sourcetype=zeek:ssl | timechart span=1m count",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show zeek:ssl events over time in 1m intervals"
    },
    {
      "id": 87,
      "prediction": "index=* sourcetype=zeek:ssl validation_status!=ok | table _time, src_ip, server_name, validation_status, error_message | sort -_time | head 10",
      "reference": "index=* sourcetype=zeek:ssl validation_status!=ok | table _time, src_ip, server_name, validation_status",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.6956521739130435,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show SSL certificate anomalies"
    },
    {
      "id": 88,
      "prediction": "index=* sourcetype=zeek:ntlm | stats count by Image | eventstats sum(count) as total | eval percentage=round((count/total)*100,2) | sort -count | head 20 | table _time, Image, count, percentage",
      "reference": "index=* sourcetype=zeek:ntlm | stats count by Image | eventstats sum(count) as total | eval percentage=round((count/total)*100,2)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.7428571428571429,
      "command_accuracy": 0.6666666666666666,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Group zeek:ntlm events by Image and show percentages"
    },
    {
      "id": 89,
      "prediction": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 Image=*powershell.exe* | table _time, Computer, CommandLine | stats count by Computer, CommandLine | sort -count | head 20 | eval percentage=round((count/sum(count))*100,2) | where percentage>5 | eval alert=if(match(CommandLine,\"Invoke-\") AND match(CommandLine,\"EncodedCommand\"), \"PowerShell Encoding Detected\", \"PowerShell Execution Detected\") | info alert, Computer, CommandLine, percentage",
      "reference": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 Image=*powershell.exe* | table _time, Computer, CommandLine",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.43902439024390244,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Detect PowerShell execution events"
    },
    {
      "id": 90,
      "prediction": "index=* | show error_code IN (*500*) | table _time, src_ip, user, status_message",
      "reference": "index=zeek sourcetype=zeek_http status_code>=500 | table _time id.orig_h host uri status_code",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.1904761904761905,
      "command_accuracy": 1.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show all 500 series server errors"
    },
    {
      "id": 91,
      "prediction": "index=* | timechart span=1h sum(duration) as total_duration | eval avg_duration = round((total_duration/3600),2) | table _time, total_duration, avg_duration",
      "reference": "index=* | timechart span=1h sum(duration)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5263157894736842,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Calculate total duration per hour"
    },
    {
      "id": 92,
      "prediction": "index=* sourcetype=XmlWinEventLog:Security | top limit=10 method | table _time, Computer, Image, CommandLine, User, EventCode, EventType, EventCode_Name, EventType_Name, Method | sort -eventcode | head 10",
      "reference": "index=* sourcetype=XmlWinEventLog:Security | top limit=10 method",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.4615384615384615,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show top 10 method from XmlWinEventLog:Security"
    },
    {
      "id": 93,
      "prediction": "index=* sourcetype=\"zeek:conn\" | stats dc(dest_port) as unique_ports, values(dest_port) as ports by src_ip, dest_ip | where unique_ports > 20 | sort -unique_ports | head 10 | table _time, src_ip, dest_ip, unique_ports | eval scan_rate = round((unique_ports / (24 * 60)) * 60, 2) | eval total_ports = sum(unique_ports) over time span=30m | where scan_rate > 50 AND total_ports > 1000 | alert \"Port Scan Detection\" | info \"IPs: %src_ip% and %dest_ip%, Unique Ports: %scan_rate% per hour, Total Ports: %total_ports% in the last 30 minutes.\"",
      "reference": "index=* sourcetype=zeek:conn | stats dc(dest_port) as unique_ports, values(dest_port) as ports by src_ip, dest_ip | where unique_ports > 20",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3896103896103896,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Detect port scanning activity"
    },
    {
      "id": 94,
      "prediction": "index=* connection | stats count by src_ip, dest_ip | where count > 5 | sort -count | head 20 | table _time id.orig_h host user service action result | eval failure_rate = round((count/sum(count))*100,2) | eval total_attempts = sum(count) | eval success_rate = round(((count-failure)/total_attempts)*100,2) | eval avg_failures_per_hour = round((count/(60*60))) | eval avg_successes_per_hour = round(((count-failure)/total_attempts)/3600) | eval duration_avg = if(action=\"failed\", \"Failed\", \"Success\") | eval duration_max = max(duration) as max_duration | eval duration_min = min(duration) as min_duration | eval duration_range = max_duration - min_duration | eval duration_median = median(duration) as median_duration | eval duration_p75 = p75(duration) as p75_duration | eval duration_p95 = p95(duration) as p95_duration | eval duration_p99 = p99(duration) as p99_duration | eval duration_stddev = stdev(duration) as stddev_duration | eval duration_percentile_50 = percentile(duration, 50) as p50_duration | eval duration_percentile_90 = percentile(duration, 90) as p90_duration | eval duration_percentile_95 = percentile(duration, 95) as p95_duration | eval duration_percentile_99 = percentile(duration, 99) as p99_duration | eval duration_q1 = quantile(duration, 0.25) as q1_duration | eval duration_q3 = quantile(duration, 0.75) as q3_duration | eval duration_iqr = iqr(duration) as iqr_duration | eval duration_mode = mode(duration) as mode_duration | eval duration_skewness = skew(duration) as skewness_duration | eval duration_kurtosis = kurtosis",
      "reference": "index=zeek sourcetype=zeek_conn conn_state=\"S0\" | table _time id.orig_h id.resp_h id.resp_p",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.07920792079207921,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show me all failed connection attempts"
    },
    {
      "id": 95,
      "prediction": "index=* sourcetype=zeek:software earliest=-15m | table _time, src_ip, dest_ip, command_line | sort -_time | head 20",
      "reference": "index=* sourcetype=zeek:software earliest=-15m",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.375,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show me all zeek:software logs from the last 15m"
    },
    {
      "id": 96,
      "prediction": "index=* failed earliest=-30d | table _time, src_ip, dest_ip, query | sort -_time | head 20 | stats count by user | where count > 5 | sort -count | head 10 | eval percentage = round((count/sum(count))*100,2) | format percentage as \"%.2f%%\" | table _time, src_ip, dest_ip, query, count, percentage | sort -percentage | head 10",
      "reference": "index=* failed earliest=-30d",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.17142857142857143,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Search for failed in the last 30d"
    },
    {
      "id": 97,
      "prediction": "index=* src_ip=\"192.168.1.100\" | table _time, src_ip, dest_ip, dest_port, event_type, message | sort -_time | paginate 50 | stats count by user, dest_ip, dest_port | where count > 30 | eval threshold=(count/30)*100 | where threshold < 70 | search index=* (action=success OR action=failure) | table _time, src_ip, dest_ip, dest_port, event_type, message | sort -_time | paginate 50 | stats count by user, dest_ip, dest_port | where count > 40 | eval percentage=(count/40)*100 | where percentage < 60 | table _time, src_ip, dest_ip, dest_port, event_type, message | sort -_time | paginate 50 | stats count by user, dest_ip, dest_port | where count > 50 | eval percentage=(count/50)*100 | where percentage < 80 | table _time, src_ip, dest_ip, dest_port, event_type, message | sort -_time | paginate 50 | stats count by user, dest_ip, dest_port | where count > 100 | eval percentage=(count/100)*100 | where percentage < 90 | table _time, src_ip, dest_ip, dest_port, event_type, message | sort -_time | paginate 50 | stats count by user, dest_ip, dest_port | where count > 200 | eval percentage=(count/200)*100 | where percentage < 95 | table _time, src_ip, dest_ip, dest_port, event_type, message | sort -_time | paginate 50 | stats count by user, dest_ip, dest_port | where count > 500 | eval percentage=(count/500)*100 | where percentage < 98 | table _time, src_ip, dest_ip, dest_port, event_type, message | sort -_time | paginate 50 | stats count by user,",
      "reference": "index=* src_ip=192.168.1.100",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.041666666666666664,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Display all logs from source IP 192.168.1.100"
    },
    {
      "id": 98,
      "prediction": "index=windows EventCode=4657 | eval reg_modification_time=_time | join [search index=windows EventCode=4103 | eval task_creation_time=_time] on _time, Computer | where reg_modification_time < task_creation_time | table _time Computer User Key Value Action | stats count avg(count) as average by User, Key, Action | sort -average | head 20",
      "reference": "index=windows EventCode=4657 Object_Name=\"*\\CurrentVersion\\Run*\" | eval reg_time=_time | stats earliest(reg_time) as registry_modification by host, user | join host user [search index=windows EventCode=4698 | eval task_time=_time | stats earliest(task_time) as task_creation by host, user] | where task_creation > registry_modification AND task_creation < (registry_modification + 600)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3870967741935484,
      "command_accuracy": 0.7692307692307693,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find registry persistence followed by scheduled task creation"
    },
    {
      "id": 99,
      "prediction": "index=* sourcetype=zeek:conn | bin _time span=1h | stats count by _time, src_ip, dest_ip | eventstats avg(count) as avg_count by src_ip, dest_ip | where count > (avg_count * 0.8) AND count < (avg_count * 1.2) | eval strength = if(count >= (avg_count * 0.9), 1, 0) | where strength == 1 AND src_ip != dest_ip | table _time, src_ip, dest_ip, count, strength | sort -count | head 50 | eval pair = strcat(src_ip,\"-\",dest_ip) | stats dc(pair) as unique_pairs, values(pair) as pairs by src_ip, dest_ip | where unique_pairs > 3 | sort -unique_pairs | head 10 | table _time, src_ip, dest_ip, unique_pairs | eval total_connections = sum(count) | where total_connections > 100 | sort -total_connections | head 20 | table _time, src_ip, dest_ip, total_connections",
      "reference": "index=* sourcetype=zeek:conn | bin _time span=1h | stats count by _time, src_ip, dest_ip | eventstats avg(count) as avg_count by src_ip, dest_ip | where count > (avg_count * 0.8) AND count < (avg_count * 1.2)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5853658536585366,
      "command_accuracy": 0.6,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find beaconing behavior in network connections"
    },
    {
      "id": 100,
      "prediction": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 | eval is_temp=if(match(Process, \"(?i)temp|%TEMP%)\")==true, 1, 0) | where is_temp=1 | table _time Computer User Process CommandLine ParentImage | sort -_time | head 25 | more cols=30 | rex field=_time \"^(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2})\" | stats count by _time, Computer, User, Process, ParentImage | sort -count | head 10 | eval percentage=round((count/sum(count))*100,2) | format percentage \"%\" | eval total=sum(count) | info total rows=total | table _time, Computer, User, Process, ParentImage, percentage | sort -percentage | tail 10",
      "reference": "sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 Image=\"*\\\\Temp\\\\*\" | table _time Computer User Image CommandLine",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.27586206896551724,
      "command_accuracy": 0.2222222222222222,
      "syntax_valid": false,
      "clarification_match": 1.0,
      "instruction": "Find all processes executed from temp directories"
    },
    {
      "id": 101,
      "prediction": "index=* sourcetype=zeek:pe ParentImage=trojan | table _time, Computer, CommandLine, ParentImage, ProcessId, ExitCode, Image | sort -_time | head 20",
      "reference": "index=* sourcetype=zeek:pe ParentImage=trojan",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3157894736842105,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find ParentImage=trojan in zeek:pe logs"
    },
    {
      "id": 102,
      "prediction": "index=* host=server-dc01 | table _time, src_ip, dest_ip, event_type, alert.signature | sort -_time | head 20",
      "reference": "index=* host=server-dc01",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.2666666666666667,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get all events from host server-dc01"
    },
    {
      "id": 103,
      "prediction": "index=* sourcetype=zeek:dns | eval query_length=len(query) | where query_length > 50 | stats count avg(query_length) by src_ip, query | where count > 10 AND query IN (*google.com*) | sort -count | head 20 | table _time id.orig_h query count | join [search index=* sourcetype=zeek:http | eval uri_length=len(uri) | where uri_length > 30 AND uri IN (*api.google.com*)] | stats dc(id.resp_h) as unique_servers, values(id.resp_h) as servers by id.orig_h, query | where unique_servers > 5 AND unique_servers NOT IN (*8.8.8.8*, *8.8.4.4*) | sort -unique_servers | head 10 | table _time id.orig_h query unique_servers | join user | where isnotnull(user) | stats count by user, unique_servers | where count < 5 | sort -count | head 10 | table _time user query unique_servers | join alert.category=\"DNS Tunneling\" | table _time, user, query, unique_servers, alert.message | stats count by alert.action | where count = 0 | sort -alert.severity | head 10 | table _time user query unique_servers alert.message alert.action | join alert.destination | table _time user query unique_servers dest_port dest_ip alert.message alert.action | join alert.signature | table _time user query unique_servers signature alert.action | join alert.dest_domain | table _time user query unique_servers dest_domain alert.action | join alert.src_domain | table _time user query unique_servers src_domain alert.action | join alert.query_type | table _time user query unique_servers query_type alert.action | join alert.answer_type | table _time user query unique_servers answer_type alert.action | join alert.ttl | table _time user query unique_servers ttl alert.action | join alert.rcode | table _time user query unique_servers rcode alert.action | join alert.answers | table",
      "reference": "index=* sourcetype=zeek:dns | eval query_length=len(query) | where query_length > 50 | stats count avg(query_length) by src_ip, query | where count > 10",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.34408602150537637,
      "command_accuracy": 0.5454545454545454,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Identify DNS tunneling attempts"
    },
    {
      "id": 104,
      "prediction": "index=* status_code=404 | table _time, src_ip, user, uri, referrer, agent | sort -_time | paginate limit=25 | display | search index=* status_code=404 (NOT IN (*search.php*) AND NOT IN (*login.php*)) | stats count by user, uri | where count > 10 | sort -count | head 10 | display",
      "reference": "index=zeek sourcetype=zeek_http status_code=404 | table _time id.orig_h host uri",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.19999999999999998,
      "command_accuracy": 0.2857142857142857,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Display all 404 errors"
    },
    {
      "id": 105,
      "prediction": "index=* sourcetype=zeek:conn proto=udp | table _time, src_ip, dest_ip, bytes | sort -bytes | head 20 | stats count avg(bytes) by src_ip, dest_ip | where count > 5 | eval total = sum(bytes) | sort -total | head 10 | table _time, src_ip, dest_ip, bytes, count, total",
      "reference": "index=* sourcetype=zeek:conn proto=udp",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.1875,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get all udp traffic logs"
    },
    {
      "id": 106,
      "prediction": "index=zeek sourcetype=zeek_http | timechart span=1h count by method | line | streamstats window=24 sum(count) as total | eval percentage=round((count/total)*100, 2) | table _time, method, count, percentage",
      "reference": "index=zeek sourcetype=zeek_http | timechart span=30m count by method",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.4666666666666667,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Display HTTP traffic patterns by method over time"
    },
    {
      "id": 107,
      "prediction": "index=* | stats count by query | sort -count | head 20 | eval percentage=round((count/sum(count))*100,2) | format _time,query,percentage | table _time,query,percentage",
      "reference": "index=* | stats count by query | sort -count",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.6956521739130436,
      "command_accuracy": 0.5714285714285715,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show query values sorted by frequency"
    },
    {
      "id": 108,
      "prediction": "index=* | stats dc(service) as unique_services by host, service | where unique_services > 50 | sort -unique_services | head 20 | table _time id.orig_h id.resp_h unique_services | more limit=100 | eval total_services = sum(unique_services) | info \"Total unique services across hosts: $total_services\"",
      "reference": "index=zeek sourcetype=zeek_conn | stats count by service | sort service",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.24390243902439024,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "List all unique services seen on the network"
    },
    {
      "id": 109,
      "prediction": "index=* | stats sum(price) as total_revenue by product_id | join [search index=customer action=purchase] | stats dc(user_id) as unique_customers by product_id | eval avg_price = round((total_revenue / unique_customers), 2) | sort -unique_customers | head 10 | table _time, product_id, total_revenue, unique_customers, avg_price",
      "reference": "index=sales action=purchase | stats sum(price) as total_revenue, dc(customer_id) as unique_customers by product_id",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3902439024390244,
      "command_accuracy": 0.25,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "For each product ID, calculate the total revenue and the number of unique customers who purchased it."
    },
    {
      "id": 110,
      "prediction": "index=* host=email-gateway | table _time, src_ip, dest_ip, event_type, alert.signature | sort -_time | streamstats count by alert.signature | where count > 5 | eval threshold=(count/10)*2 | where count < threshold | stats count avg(count) as avg_count max(_time) as latest_alert by alert.signature | join [search index=* host=email-gateway] on alert.signature | table _time, src_ip, dest_ip, event_type, alert.signature, alert.category, alert.action | sort -_time | head 30",
      "reference": "index=* host=email-gateway",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.10526315789473684,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get all events from host email-gateway"
    },
    {
      "id": 111,
      "prediction": "index=* dest_port=139 | table _time, src_ip, dest_ip, event_type, alert.signature | stats count by user | sort -count | head 20 | eval rank = if(match(user,\"root\") OR match(user,\"admin\"), 1, 0) | where rank > 0 | eval severity = if(match(alert.signature,\"suspicious\"), \"high\", \"medium\") | eval category = if(match(dest_ip,\"172.16.5.10\"), \"internal\", \"external\") | eval action = if(match(event_type,\"connection\"), \"allow\", \"block\") | table _time, src_ip, dest_ip, user, alert.signature, severity, category, action",
      "reference": "index=* dest_port=139",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.08695652173913045,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find all events with destination port 139"
    },
    {
      "id": 112,
      "prediction": "index=* sourcetype=zeek:dce_rpc earliest=-2h | table _time, src_ip, dest_ip, command_line | sort -_time | head 50 | tail 50",
      "reference": "index=* sourcetype=zeek:dce_rpc earliest=-2h",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.35294117647058826,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show zeek:dce_rpc logs between 2h ago and now"
    },
    {
      "id": 113,
      "prediction": "index=* user=* | where isnotnull(user) | table _time, src_ip, user, message | sort -_time | head 20",
      "reference": "index=* user=* | where isnotnull(user)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5263157894736842,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find events where user is not null"
    },
    {
      "id": 114,
      "prediction": "index=* sourcetype=zeek:conn proto=udp | table _time, src_ip, dest_ip, bytes | sort -bytes | head 20 | stats count avg(bytes) by src_ip, dest_ip | where count > 5 | eval total = sum(bytes) | sort -total | head 10 | table _time, src_ip, dest_ip, bytes, count, total | streamstats window=30 count avg(count) as avg_count by src_ip, dest_ip | where count < (avg_count * 0.8) AND count > (avg_count * 0.6) | eval threshold = if(count >= (avg_count * 0.9), \"alert\", \"\") | table _time, src_ip, dest_ip, bytes, count, total, threshold | where threshold=\"alert\" | table _time, src_ip, dest_ip, alert.message | info src_port, dest_port | table _time, src_ip, dest_ip, alert.signature, alert.category | table _time, src_ip, dest_ip, alert.action | table _time, src_ip, dest_ip, alert.severity | table _time, src_ip, dest_ip, alert.priority | table _time, src_ip, dest_ip, alert.destination_port | table _time, src_ip, dest_ip, alert.source_port | table _time, src_ip, dest_ip, alert.protocol | table _time, src_ip, dest_ip, alert.service | table _time, src_ip, dest_ip, alert.query | table _time, src_ip, dest_ip, alert.user | table _time, src_ip, dest_ip, alert.status_code | table _time, src_ip, dest_ip, alert.referrer | table _time, src_ip, dest_ip, alert.uri | table _time, src_ip, dest_ip, alert.method | table _time, src_ip, dest_ip, alert.duration | table _time, src_ip, dest_ip, alert.response_body | table _time, src_ip, dest_ip, alert.request_headers |",
      "reference": "index=* sourcetype=zeek:conn proto=udp",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.0821917808219178,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get all udp traffic logs"
    },
    {
      "id": 115,
      "prediction": "index=* sourcetype=zeek:dce_rpc earliest=-30d | table _time, src_ip, dest_ip, command_line | sort -_time | head 50 | tail 50",
      "reference": "index=* sourcetype=zeek:dce_rpc earliest=-30d",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.35294117647058826,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show zeek:dce_rpc logs between 30d ago and now"
    },
    {
      "id": 116,
      "prediction": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 (Image=\"*wscript.exe\" OR Image=\"*cscript.exe\") | table _time Computer User CommandLine ParentImage | stats count by _time, Computer, User, CommandLine, ParentImage | sort -_time | head 20",
      "reference": "sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 (Image=\"*wscript.exe\" OR Image=\"*cscript.exe\") | table _time Computer User CommandLine",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.6285714285714286,
      "command_accuracy": 0.4,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Find all wscript or cscript executions"
    },
    {
      "id": 117,
      "prediction": "index=* sourcetype=zeek:weird | top limit=10 dest_ip | table _time, src_ip, dest_ip, event_type",
      "reference": "index=* sourcetype=zeek:weird | top limit=10 dest_ip",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.7058823529411764,
      "command_accuracy": 0.6666666666666666,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show top 10 dest_ip from zeek:weird"
    },
    {
      "id": 118,
      "prediction": "index=git | transaction repo | eval last_month=now-1m | stats count by user, commit_hash | sort -count | head 9 | mvexpand repo | eval rank=if(match(user,\"^[A-Z]\") AND match(repo,\".*master$\"), count+20, count) | sort -rank | head 3 | rex field=\"commit_msg\" \"([^\\n]+)\" as message | table _time, repo, user, message, count",
      "reference": "index=cicd sourcetype=gitlab event=commit earliest=-30d | stats count by repo_name, user_name | group repo_name | sort -count | streamstats count as rank by repo_name | where rank <= 3",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.3076923076923077,
      "command_accuracy": 0.36363636363636365,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "For each git repository, list the top 3 users with the most commits in the last month."
    },
    {
      "id": 119,
      "prediction": "index=* unauthorized earliest=-30m | table _time, src_ip, dest_ip, query | sort -_time | head 15",
      "reference": "index=* unauthorized earliest=-30m",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.375,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Search for unauthorized in the last 30m"
    },
    {
      "id": 120,
      "prediction": "index=* host=workstation-01 | table _time, src_ip, dest_ip, event_type, alert.signature | sort -_time | head 20",
      "reference": "index=* host=workstation-01",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.2666666666666667,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get all events from host workstation-01"
    },
    {
      "id": 121,
      "prediction": "index=* sourcetype=zeek:conn proto=tcp | table _time, src_ip, dest_ip, bytes | sort -bytes | head 20 | stats count avg(bytes) by src_ip, dest_ip | where count > 10 | eval total = sum(bytes) | sort -total | head 5 | table _time, src_ip, dest_ip, bytes, total | eval percentage = round((bytes/total)*100,2) | format percentage \"%\" | table _time, src_ip, dest_ip, bytes, total, percentage",
      "reference": "index=* sourcetype=zeek:conn proto=tcp",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.16666666666666669,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Get all tcp traffic logs"
    },
    {
      "id": 122,
      "prediction": "index=* sourcetype=zeek:smtp dest_ip=*powershell.exe* | table _time, src_ip, dest_ip, subject, body | stats count by _time, src_ip, dest_ip | sort -count | head 20 | eval score = if(match(_time,\"192.168.1.50\") AND match(dest_ip,\"172.16.5.10\"),1,0) | where score > 0 | sort -score | head 5 | eval alert=\"Suspicious email from 192.168.1.50 to 172.16.5.10\" | info alert | table _time, alert | timechart span=30m count | eventstats avg(count) as avg, stdev(count) as stdev | eval threshold=avg+(stdev*2) | where count > threshold | streamstats window=30m sum(count) as total | eval percentage=round((total/sum(eval(count))) * 100,2) | eval severity=(if(percentage>40, \"high\", \"medium\")) | info severity, percentage | table _time, severity, percentage | timechart span=1h count | eventstats avg(count) as hourly_avg, stdev(count) as hourly_stdev | eval hourly_threshold=hourly_avg+(hourly_stdev*2) | where count > hourly_threshold | streamstats window=1h sum(count) as hourly_total | eval hourly_percentage=round((hourly_total/sum(eval(count))) * 100,2) | eval hourly_severity=(if(hourly_percentage>40, \"high\", \"medium\")) | info hourly_severity, hourly_percentage | table _time, hourly_severity, hourly_percentage",
      "reference": "index=* sourcetype=zeek:smtp dest_ip=*powershell.exe*",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.0821917808219178,
      "command_accuracy": 0.0,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Show me zeek:smtp events where dest_ip contains powershell.exe"
    },
    {
      "id": 123,
      "prediction": "index=* sourcetype=zeek:conn proto=icmp | stats sum(bytes) as total_bytes by src_ip, dest_ip | where total_bytes > 104857600 | sort -total_bytes | head 20 | table _time id.orig_h id.resp_h total_bytes | eval transfer_size = round((total_bytes / (1024 * 1024)), 2) | format json | outfile \"data_exfiltration.json\"",
      "reference": "index=* sourcetype=zeek:conn proto=icmp | stats sum(bytes) as total_bytes by src_ip, dest_ip | where total_bytes > 100000000 | sort -total_bytes",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.588235294117647,
      "command_accuracy": 0.6666666666666666,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Detect data exfiltration by identifying large icmp transfers"
    },
    {
      "id": 124,
      "prediction": "index=* sourcetype=zeek:dns | eval query_length=len(query) | where query_length > 50 | stats count avg(query_length) by src_ip, query | where count > 10 AND query IN (*google.com*) | sort -count | head 20 | table _time id.orig_h query count | rex field=\"id.orig_h\" \"([^.]+\\.[^.]+\\.[^.]+\\.){3}[^\\.]+\" | stats dc(id.orig_h) as unique_ips by query | where unique_ips > 5 | sort -unique_ips | head 10 | table _time query unique_ips | join [search index=* sourcetype=zeek:http | fields _time id.orig_h uri] | where uri IN (*admin*) OR uri IN (*command*) | table _time id.orig_h query uri | join [search index=* sourcetype=zeek:smb | fields _time id.orig_h path user] | where path IN (\"*\\*.exe\") OR path IN (\"*\\*.scr\") | table _time id.orig_h query uri path user | join [search index=* sourcetype=zeek:rdp | fields _time id.orig_h session_id] | where session_id =~ /[a-z]+/ | table _time id.orig_h query uri path user session_id | join [search index=* sourcetype=zeek:pe | fields _time id.orig_h command_line] | where command_line IN (*powershell.exe*) OR command_line IN (*cmd.exe*) | table _time id.orig_h query uri path user session_id command_line | join [search index=* sourcetype=zeek:conn | fields _time id.resp_h service] | where service IN (*portmapper*) OR service IN (*workstation*) | table _time id.orig_h query uri path user session_id command_line id.resp_h | join [search index=* sourcetype=zeek:ssl | fields _time id.orig_h server_name] | where server_name IN (*gmail.com*) OR server_name",
      "reference": "index=* sourcetype=zeek:dns | eval query_length=len(query) | where query_length > 50 | stats count avg(query_length) by src_ip, query | where count > 10",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.37647058823529417,
      "command_accuracy": 0.4615384615384615,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Identify DNS tunneling attempts"
    },
    {
      "id": 125,
      "prediction": "index=* | timechart span=1h sum(duration) as total_duration | eval avg_duration = round((total_duration/3600),2) | table _time, total_duration, avg_duration",
      "reference": "index=* | timechart span=1h sum(duration)",
      "exact_match": 0.0,
      "normalized_exact_match": 0.0,
      "token_overlap": 0.5263157894736842,
      "command_accuracy": 0.5,
      "syntax_valid": true,
      "clarification_match": 1.0,
      "instruction": "Calculate total duration per hour"
    }
  ],
  "statistics": {
    "total_examples": 126,
    "clarifications_predicted": 0,
    "clarifications_reference": 2,
    "syntax_valid": 123,
    "syntax_valid_rate": 97.61904761904762
  }
}