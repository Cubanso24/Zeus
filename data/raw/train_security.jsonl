{"instruction": "Detect multiple failed login attempts from the same IP address", "input": "Time window: last 30 minutes, Threshold: more than 5 failures", "output": "index=* (failed OR failure OR \"authentication failed\") earliest=-30m | stats count by src_ip | where count > 5"}
{"instruction": "Find potential brute force attacks against user accounts", "input": "", "output": "index=* (EventCode=4625 OR \"failed password\" OR \"authentication failure\") | stats count dc(src_ip) as unique_ips by user | where count > 10 OR unique_ips > 5"}
{"instruction": "Identify lateral movement using Windows event logs", "input": "", "output": "index=windows (EventCode=4624 OR EventCode=4648) Logon_Type=3 | stats count dc(dest) as unique_destinations by user | where unique_destinations > 5"}
{"instruction": "Detect credential dumping attempts", "input": "", "output": "index=windows (EventCode=4656 OR EventCode=4663) (Object_Name=\"*\\lsass.exe\" OR Object_Name=\"*\\sam\" OR Object_Name=\"*\\system\") Access_Mask=\"*READ*\""}
{"instruction": "Find unusual outbound connections to external IPs", "input": "", "output": "index=network action=allowed direction=outbound NOT (dest_ip=10.* OR dest_ip=172.16.* OR dest_ip=192.168.*) | stats count by src_ip, dest_ip, dest_port | where count < 10"}
{"instruction": "Identify potential data exfiltration based on traffic volume", "input": "Threshold: more than 1GB uploaded", "output": "index=network direction=outbound | stats sum(bytes_out) as total_bytes by src_ip, dest_ip | where total_bytes > 1073741824 | eval total_gb = round(total_bytes/1073741824, 2)"}
{"instruction": "Detect suspicious PowerShell encoded commands", "input": "", "output": "index=windows EventCode=4104 (Message=\"*-enc*\" OR Message=\"*-EncodedCommand*\" OR Message=\"*FromBase64String*\") | table _time host user Message"}
{"instruction": "Find privilege escalation attempts", "input": "", "output": "index=windows (EventCode=4672 OR EventCode=4673 OR EventCode=4674) Privileges=\"*SeDebugPrivilege*\" | stats count by user, host"}
{"instruction": "Identify accounts created outside business hours", "input": "Business hours: 8 AM to 6 PM weekdays", "output": "index=windows EventCode=4720 | eval hour=strftime(_time, \"%H\") | eval day=strftime(_time, \"%w\") | where (hour < 8 OR hour >= 18) OR (day=0 OR day=6)"}
{"instruction": "Detect potential ransomware file activity", "input": "", "output": "index=windows EventCode=4663 (Object_Name=\"*.encrypted\" OR Object_Name=\"*.locked\" OR Object_Name=\"*.crypto\" OR Object_Name=\"*READ_ME*.txt\") | stats count dc(Object_Name) as unique_files by user, host | where unique_files > 50"}
{"instruction": "Find suspicious process creation with living off the land binaries", "input": "", "output": "index=windows EventCode=4688 (Process_Name=\"*\\certutil.exe\" OR Process_Name=\"*\\bitsadmin.exe\" OR Process_Name=\"*\\wmic.exe\" OR Process_Name=\"*\\regsvr32.exe\") | table _time host user Process_Name Process_Command_Line"}
{"instruction": "Identify beaconing activity based on regular intervals", "input": "", "output": "index=network dest_port=443 | bucket _time span=1m | stats count by _time, src_ip, dest_ip | eventstats stdev(count) as std_dev avg(count) as avg_count by src_ip, dest_ip | where std_dev < 2 AND avg_count > 5"}
{"instruction": "Detect new scheduled tasks created", "input": "Time range: last 7 days", "output": "index=windows EventCode=4698 earliest=-7d | table _time host user Task_Name"}
{"instruction": "Find potential DDoS traffic patterns", "input": "", "output": "index=network | bucket _time span=1m | stats count as connections by _time, dest_ip | where connections > 1000"}
{"instruction": "Identify unauthorized USB device usage", "input": "", "output": "index=windows EventCode=2003 sourcetype=WinEventLog:System | rex field=Message \"Device (?<device_id>[^\\s]+)\" | stats count by host, user, device_id"}
{"instruction": "Detect suspicious registry modifications", "input": "Focus on Run keys and persistence mechanisms", "output": "index=windows EventCode=4657 Object_Name=\"*\\Microsoft\\Windows\\CurrentVersion\\Run*\" | table _time host user Object_Name New_Value"}
{"instruction": "Find web shells or suspicious web uploads", "input": "", "output": "index=web http_method=POST uri=\"*.php\" OR uri=\"*.jsp\" OR uri=\"*.asp\" OR uri=\"*.aspx\" (bytes_in > 10000 OR status=200) | table _time src_ip uri user_agent"}
{"instruction": "Identify anomalous DNS queries", "input": "Detect queries to algorithmically generated domains", "output": "index=dns | eval domain_length=len(query) | where domain_length > 30 | rex field=query \"^(?<subdomain>[^\\.]+)\" | eval subdomain_length=len(subdomain) | where subdomain_length > 15"}
{"instruction": "Detect Kerberoasting attacks", "input": "", "output": "index=windows EventCode=4769 Ticket_Encryption_Type=0x17 Service_Name!=\"*$\" | stats count by user, Service_Name | where count > 5"}
{"instruction": "Find suspicious email attachments", "input": "", "output": "index=email attachment=\"*.exe\" OR attachment=\"*.scr\" OR attachment=\"*.js\" OR attachment=\"*.vbs\" OR attachment=\"*.dll\" | table _time sender recipient subject attachment"}
