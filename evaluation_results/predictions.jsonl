{"id": 0, "instruction": "Correlate failed firewall rules with subsequent successful connections", "input": "", "reference": "index=firewall action=blocked | stats earliest(_time) as block_time by src_ip, dest_ip, dest_port | join src_ip dest_ip dest_port [search index=firewall action=allowed | stats latest(_time) as allow_time by src_ip, dest_ip, dest_port] | where allow_time > block_time AND allow_time < (block_time + 3600)", "prediction": "index=firewall action=denied | eval rule_time=_time | join host [search index=network action=accept | eval success_time=_time] | where success_time > rule_time AND success_time < (rule_time + 60) | table host, rule_id, src_ip, dest_ip, protocol, src_port, dest_port, action, success_time, rule_time | sort -success_time | head 1000", "metrics": {"id": 0, "prediction": "index=firewall action=denied | eval rule_time=_time | join host [search index=network action=accept | eval success_time=_time] | where success_time > rule_time AND success_time < (rule_time + 60) | table host, rule_id, src_ip, dest_ip, protocol, src_port, dest_port, action, success_time, rule_time | sort -success_time | head 1000", "reference": "index=firewall action=blocked | stats earliest(_time) as block_time by src_ip, dest_ip, dest_port | join src_ip dest_ip dest_port [search index=firewall action=allowed | stats latest(_time) as allow_time by src_ip, dest_ip, dest_port] | where allow_time > block_time AND allow_time < (block_time + 3600)", "exact_match": 0.0, "normalized_exact_match": 0.0, "token_overlap": 0.3666666666666667, "command_accuracy": 0.5454545454545454, "syntax_valid": true, "clarification_match": 1.0, "instruction": "Correlate failed firewall rules with subsequent successful connections"}}
{"id": 1, "instruction": "Get me the logs for that issue", "input": "", "reference": "CLARIFICATION: To retrieve the relevant logs, I need:\n- Which issue or incident are you referring to?\n- What systems or applications?\n- Specific time range?\n- What index should I search?\n- Any error codes, alert IDs, or other identifiers?\n- Need all logs or filtered by specific criteria?", "prediction": "CLARIFICATION: To investigate the issue, I need:\n- Specific time range or index filter?\n- Which system or application logs?\n- What type of issue (error messages, performance, authentication)?\n- Are you looking for events or searching for specific keywords?\n- Do you need raw logs or aggregated statistics?\n- What index or source?\n- Do you need logs from a specific user or all users?\n- What threshold or severity level?\n- Do you need logs from the last hour or from the last week?\n- Do you need logs from the application server or web server?\n- Do you need logs from the database or file system?\n- Do you need logs from the network or firewall?\n- Do you need logs from the operating system or application logs?\n- Do you need logs from the application logs or system logs?\n- Do you need logs from the application logs or database logs?\n- Do you need logs from the application logs or network logs?\n- Do you need logs from the application logs or file system logs?\n- Do you need logs from the application logs or authentication logs?\n- Do you need logs from the application logs or error logs?\n- Do you need logs from the application logs or access logs?\n- Do you need logs from the application logs or performance logs?\n- Do you need logs from the application logs or security logs?\n- Do you need logs from the application logs or system logs?\n- Do you need logs from the application logs or custom logs?\n- Do you need logs from the application logs or indexed logs?\n- Do you need logs from the application logs or real-time logs?\n- Do you need logs from the application logs or historical logs?\n- Do you need logs from the application logs or indexed events?\n- Do you need logs from the application logs or indexed metrics?\n- Do you need logs from the application logs or indexed traces?\n- Do you need logs from the application logs or indexed transactions?\n- Do you need logs from the application logs or indexed alerts?\n- Do you need logs from the application logs or indexed anomalies?\n- Do you need logs from the application logs or indexed errors?\n- Do you need logs from the application logs or indexed warnings?\n- Do you need logs from the application logs or indexed criticals?\n- Do you", "metrics": {"id": 1, "prediction": "CLARIFICATION: To investigate the issue, I need:\n- Specific time range or index filter?\n- Which system or application logs?\n- What type of issue (error messages, performance, authentication)?\n- Are you looking for events or searching for specific keywords?\n- Do you need raw logs or aggregated statistics?\n- What index or source?\n- Do you need logs from a specific user or all users?\n- What threshold or severity level?\n- Do you need logs from the last hour or from the last week?\n- Do you need logs from the application server or web server?\n- Do you need logs from the database or file system?\n- Do you need logs from the network or firewall?\n- Do you need logs from the operating system or application logs?\n- Do you need logs from the application logs or system logs?\n- Do you need logs from the application logs or database logs?\n- Do you need logs from the application logs or network logs?\n- Do you need logs from the application logs or file system logs?\n- Do you need logs from the application logs or authentication logs?\n- Do you need logs from the application logs or error logs?\n- Do you need logs from the application logs or access logs?\n- Do you need logs from the application logs or performance logs?\n- Do you need logs from the application logs or security logs?\n- Do you need logs from the application logs or system logs?\n- Do you need logs from the application logs or custom logs?\n- Do you need logs from the application logs or indexed logs?\n- Do you need logs from the application logs or real-time logs?\n- Do you need logs from the application logs or historical logs?\n- Do you need logs from the application logs or indexed events?\n- Do you need logs from the application logs or indexed metrics?\n- Do you need logs from the application logs or indexed traces?\n- Do you need logs from the application logs or indexed transactions?\n- Do you need logs from the application logs or indexed alerts?\n- Do you need logs from the application logs or indexed anomalies?\n- Do you need logs from the application logs or indexed errors?\n- Do you need logs from the application logs or indexed warnings?\n- Do you need logs from the application logs or indexed criticals?\n- Do you", "reference": "CLARIFICATION: To retrieve the relevant logs, I need:\n- Which issue or incident are you referring to?\n- What systems or applications?\n- Specific time range?\n- What index should I search?\n- Any error codes, alert IDs, or other identifiers?\n- Need all logs or filtered by specific criteria?", "exact_match": 0.0, "normalized_exact_match": 0.0, "token_overlap": 0.3247863247863248, "command_accuracy": 0.0, "syntax_valid": true, "clarification_match": 1.0, "instruction": "Get me the logs for that issue"}}
{"id": 2, "instruction": "Find registry persistence followed by scheduled task creation", "input": "", "reference": "index=windows EventCode=4657 Object_Name=\"*\\CurrentVersion\\Run*\" | eval reg_time=_time | stats earliest(reg_time) as registry_modification by host, user | join host user [search index=windows EventCode=4698 | eval task_time=_time | stats earliest(task_time) as task_creation by host, user] | where task_creation > registry_modification AND task_creation < (registry_modification + 600)", "prediction": "index=windows EventCode=4657 Object_Name=\"*\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" | eval registry_time=_time | join host [search index=windows EventCode=4698 Object_Name=\"*\\Microsoft\\Windows\\CurrentVersion\\Schedule\\Tasks\\*\" | eval task_time=_time] | where task_time > registry_time AND task_time < (registry_time + 3600) | table host, Object_Name, User, registry_time, task_time", "metrics": {"id": 2, "prediction": "index=windows EventCode=4657 Object_Name=\"*\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" | eval registry_time=_time | join host [search index=windows EventCode=4698 Object_Name=\"*\\Microsoft\\Windows\\CurrentVersion\\Schedule\\Tasks\\*\" | eval task_time=_time] | where task_time > registry_time AND task_time < (registry_time + 3600) | table host, Object_Name, User, registry_time, task_time", "reference": "index=windows EventCode=4657 Object_Name=\"*\\CurrentVersion\\Run*\" | eval reg_time=_time | stats earliest(reg_time) as registry_modification by host, user | join host user [search index=windows EventCode=4698 | eval task_time=_time | stats earliest(task_time) as task_creation by host, user] | where task_creation > registry_modification AND task_creation < (registry_modification + 600)", "exact_match": 0.0, "normalized_exact_match": 0.0, "token_overlap": 0.5185185185185186, "command_accuracy": 0.8000000000000002, "syntax_valid": true, "clarification_match": 1.0, "instruction": "Find registry persistence followed by scheduled task creation"}}
{"id": 3, "instruction": "Identify RDP sessions from unusual geolocations", "input": "", "reference": "index=windows EventCode=4624 Logon_Type=10 | iplocation src_ip | join user [search index=windows EventCode=4624 Logon_Type=10 earliest=-90d latest=-1d | iplocation src_ip | stats values(Country) as normal_countries by user] | where NOT match(normal_countries, Country)", "prediction": "index=windows EventCode=4624 (Action=\"Logon\" OR Action=\"Logoff\") (Process_Name=\"winlogon.exe\" OR Process_Name=\"wtsapi32.exe\") | rex field=Process_Command_Line \"(?<rdp_port>\\d+)\" | eval rdp_port=_time rdp_port | join host [search index=network | eval geo_location=_time geo_location] | where not isnull(geo_location) AND rdp_port != \"\" | eval distance=distance(geo_location, host) | where distance > 500 | table _time, host, user, geo_location, rdp_port, Action, Process_Name, distance", "metrics": {"id": 3, "prediction": "index=windows EventCode=4624 (Action=\"Logon\" OR Action=\"Logoff\") (Process_Name=\"winlogon.exe\" OR Process_Name=\"wtsapi32.exe\") | rex field=Process_Command_Line \"(?<rdp_port>\\d+)\" | eval rdp_port=_time rdp_port | join host [search index=network | eval geo_location=_time geo_location] | where not isnull(geo_location) AND rdp_port != \"\" | eval distance=distance(geo_location, host) | where distance > 500 | table _time, host, user, geo_location, rdp_port, Action, Process_Name, distance", "reference": "index=windows EventCode=4624 Logon_Type=10 | iplocation src_ip | join user [search index=windows EventCode=4624 Logon_Type=10 earliest=-90d latest=-1d | iplocation src_ip | stats values(Country) as normal_countries by user] | where NOT match(normal_countries, Country)", "exact_match": 0.0, "normalized_exact_match": 0.0, "token_overlap": 0.23333333333333334, "command_accuracy": 0.5454545454545454, "syntax_valid": true, "clarification_match": 1.0, "instruction": "Identify RDP sessions from unusual geolocations"}}
{"id": 4, "instruction": "Show trend of security events over the last 24 hours", "input": "", "reference": "index=security earliest=-24h | timechart span=1h count by severity", "prediction": "index=* (action=blocked OR action=alert) | stats count by _time span(1h) as hour | sort -count | table _time, hour, count | head 24 | eval total=cumsum(count) | eval last_hour=total[-1] | eval percentage=round(last_hour/total*100, 2) | eval trend=(last_hour>total[-2]?\"↑\":\"↓\") | eval trend_percentage=(last_hour/total[-2]-1)*100 | sort -count | head 10 | eval last_hour_formatted=_time[hour] | eval last_hour_formatted=strftime(_time, \"%Y-%m-%d %H:%M:%S\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d %H:%M\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%m-%d\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%d\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%H:%M\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%H\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%M\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%S\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d %H:%M:%S\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d %H:%M:%S\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d %H:%M\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d\") | eval last_hour_formatted=strftime(last_hour_form", "metrics": {"id": 4, "prediction": "index=* (action=blocked OR action=alert) | stats count by _time span(1h) as hour | sort -count | table _time, hour, count | head 24 | eval total=cumsum(count) | eval last_hour=total[-1] | eval percentage=round(last_hour/total*100, 2) | eval trend=(last_hour>total[-2]?\"↑\":\"↓\") | eval trend_percentage=(last_hour/total[-2]-1)*100 | sort -count | head 10 | eval last_hour_formatted=_time[hour] | eval last_hour_formatted=strftime(_time, \"%Y-%m-%d %H:%M:%S\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d %H:%M\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%m-%d\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%d\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%H:%M\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%H\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%M\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%S\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d %H:%M:%S\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d %H:%M:%S\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d %H:%M\") | eval last_hour_formatted=strftime(last_hour_formatted, \"%Y-%m-%d\") | eval last_hour_formatted=strftime(last_hour_form", "reference": "index=security earliest=-24h | timechart span=1h count by severity", "exact_match": 0.0, "normalized_exact_match": 0.0, "token_overlap": 0.12244897959183672, "command_accuracy": 0.0, "syntax_valid": false, "clarification_match": 1.0, "instruction": "Show trend of security events over the last 24 hours"}}
{"id": 5, "instruction": "Show events grouped by hour of day and day of week", "input": "", "reference": "index=* | eval hour=strftime(_time, \"%H\") | eval day=strftime(_time, \"%A\") | stats count by hour, day", "prediction": "index=* | stats count by _time span(hour) as hour, day_of_week(_time) as day | table hour, day, count | sort -count | head 24*7 | rex field=hour match=\"(\\d{2})\" | eval hour=strftime(hour, \"%I %p\") | eval day=strftime(day, \"%A\") | eval time=strftime(hour, \"%I:%M %p\") | eval date=strftime(_time, \"%Y-%m-%d\") | eval timestamp=_time | eval index=_time | eval message=_message | eval level=_level | eval host=_host | eval src_ip=_src_ip | eval dest_ip=_dest_ip | eval user=_user | eval event=_event | eval alert=_alert | eval severity=_severity | eval response_code=_response_code | eval duration=_duration | eval action=_action | eval src_process=_src_process | eval dest_process=_dest_process | eval src_user_agent=_src_user_agent | eval dest_user_agent=_dest_user_agent | eval src_port=_src_port | eval dest_port=_dest_port | eval src_bytes=_src_bytes | eval dest_bytes=_dest_bytes | eval src_packets=_src_packets | eval dest_packets=_dest_packets | eval src_protocol=_src_protocol | eval dest_protocol=_dest_protocol | eval src_service=_src_service | eval dest_service=_dest_service | eval src_country=_src_country | eval dest_country=_dest_country | eval src_city=_src_city | eval dest_city=_dest_city | eval src_latitude=_src_latitude | eval dest_latitude=_dest_latitude | eval src_asn=_src_asn | eval dest_asn=_dest_asn | eval src_org=_src_org | eval dest_org=_dest_org | eval src_domain=_src_domain | eval dest_domain=_dest_domain | eval src_url=_src_url | eval dest_url=_dest_url | eval src_query=_src_query | eval dest_query=_dest_query | eval src_referer=_src_referer | eval dest_referer", "metrics": {"id": 5, "prediction": "index=* | stats count by _time span(hour) as hour, day_of_week(_time) as day | table hour, day, count | sort -count | head 24*7 | rex field=hour match=\"(\\d{2})\" | eval hour=strftime(hour, \"%I %p\") | eval day=strftime(day, \"%A\") | eval time=strftime(hour, \"%I:%M %p\") | eval date=strftime(_time, \"%Y-%m-%d\") | eval timestamp=_time | eval index=_time | eval message=_message | eval level=_level | eval host=_host | eval src_ip=_src_ip | eval dest_ip=_dest_ip | eval user=_user | eval event=_event | eval alert=_alert | eval severity=_severity | eval response_code=_response_code | eval duration=_duration | eval action=_action | eval src_process=_src_process | eval dest_process=_dest_process | eval src_user_agent=_src_user_agent | eval dest_user_agent=_dest_user_agent | eval src_port=_src_port | eval dest_port=_dest_port | eval src_bytes=_src_bytes | eval dest_bytes=_dest_bytes | eval src_packets=_src_packets | eval dest_packets=_dest_packets | eval src_protocol=_src_protocol | eval dest_protocol=_dest_protocol | eval src_service=_src_service | eval dest_service=_dest_service | eval src_country=_src_country | eval dest_country=_dest_country | eval src_city=_src_city | eval dest_city=_dest_city | eval src_latitude=_src_latitude | eval dest_latitude=_dest_latitude | eval src_asn=_src_asn | eval dest_asn=_dest_asn | eval src_org=_src_org | eval dest_org=_dest_org | eval src_domain=_src_domain | eval dest_domain=_dest_domain | eval src_url=_src_url | eval dest_url=_dest_url | eval src_query=_src_query | eval dest_query=_dest_query | eval src_referer=_src_referer | eval dest_referer", "reference": "index=* | eval hour=strftime(_time, \"%H\") | eval day=strftime(_time, \"%A\") | stats count by hour, day", "exact_match": 0.0, "normalized_exact_match": 0.0, "token_overlap": 0.20454545454545453, "command_accuracy": 0.5, "syntax_valid": true, "clarification_match": 1.0, "instruction": "Show events grouped by hour of day and day of week"}}
{"id": 6, "instruction": "Analyze authentication patterns by location", "input": "", "reference": "index=* authentication | iplocation src_ip | stats count by Country, City | sort -count", "prediction": "index=* (action=login OR action=authentication) | stats count by src_ip, bin(time)=30m | eval location=if(isnull(user_agent_city), \"Unknown\", user_agent_city) | stats count by location | table _time, location, count | sort -count | head 50", "metrics": {"id": 6, "prediction": "index=* (action=login OR action=authentication) | stats count by src_ip, bin(time)=30m | eval location=if(isnull(user_agent_city), \"Unknown\", user_agent_city) | stats count by location | table _time, location, count | sort -count | head 50", "reference": "index=* authentication | iplocation src_ip | stats count by Country, City | sort -count", "exact_match": 0.0, "normalized_exact_match": 0.0, "token_overlap": 0.4117647058823529, "command_accuracy": 0.5, "syntax_valid": true, "clarification_match": 1.0, "instruction": "Analyze authentication patterns by location"}}
{"id": 7, "instruction": "Identify accounts with privileges not matching their department", "input": "Using lookup table: user_departments.csv", "reference": "index=windows EventCode=4672 | lookup user_departments.csv user OUTPUT department, expected_privileges | where Privileges!=expected_privileges | table user, department, Privileges, expected_privileges", "prediction": "index=windows EventCode=4672 Object_Name=\"*Administrators*\" | eval department=host(user) | join user department [search index=windows EventCode=4624 Object_Name=\"*Access granted*\" | eval effective_privilege=Object_Name | stats values(effective_privilege) as privileges by user] | where isnotnull(department) and isnotnull(privileges) | eval mismatch=if(len(strsplit(privileges, \" \")[0]) != len(strsplit(department, \" \")[0]) OR strcmp(strsplit(privileges, \" \")[0], strsplit(department, \" \")[0]) != 0, \"Yes\", \"No\") | where mismatch=\"Yes\" | table user, department, privileges", "metrics": {"id": 7, "prediction": "index=windows EventCode=4672 Object_Name=\"*Administrators*\" | eval department=host(user) | join user department [search index=windows EventCode=4624 Object_Name=\"*Access granted*\" | eval effective_privilege=Object_Name | stats values(effective_privilege) as privileges by user] | where isnotnull(department) and isnotnull(privileges) | eval mismatch=if(len(strsplit(privileges, \" \")[0]) != len(strsplit(department, \" \")[0]) OR strcmp(strsplit(privileges, \" \")[0], strsplit(department, \" \")[0]) != 0, \"Yes\", \"No\") | where mismatch=\"Yes\" | table user, department, privileges", "reference": "index=windows EventCode=4672 | lookup user_departments.csv user OUTPUT department, expected_privileges | where Privileges!=expected_privileges | table user, department, Privileges, expected_privileges", "exact_match": 0.0, "normalized_exact_match": 0.0, "token_overlap": 0.29629629629629634, "command_accuracy": 0.4444444444444444, "syntax_valid": true, "clarification_match": 1.0, "instruction": "Identify accounts with privileges not matching their department"}}
{"id": 8, "instruction": "Detect account lockouts followed by password resets from different IP", "input": "", "reference": "index=windows EventCode=4740 | eval lockout_time=_time | stats earliest(lockout_time) as locked_time, values(src_ip) as lockout_ip by user | join user [search index=windows EventCode=4724 | eval reset_time=_time | stats latest(reset_time) as password_reset_time, values(src_ip) as reset_ip by user] | where password_reset_time > locked_time AND password_reset_time < (locked_time + 7200) AND lockout_ip!=reset_ip", "prediction": "index=windows EventCode=4625 (Action=\"Account locked out\" OR Action=\"Account locked out: failed login attempt\") | eval lockout_time=_time | join user [search index=windows EventCode=4632 Object_Name=\"*Password*\" Action=\"*Set*\" | eval reset_time=_time] | where reset_time > lockout_time AND reset_time < (lockout_time + 3600) | stats count dc(dest) as unique_ips by user | where unique_ips > 1 | table user, count, unique_ips", "metrics": {"id": 8, "prediction": "index=windows EventCode=4625 (Action=\"Account locked out\" OR Action=\"Account locked out: failed login attempt\") | eval lockout_time=_time | join user [search index=windows EventCode=4632 Object_Name=\"*Password*\" Action=\"*Set*\" | eval reset_time=_time] | where reset_time > lockout_time AND reset_time < (lockout_time + 3600) | stats count dc(dest) as unique_ips by user | where unique_ips > 1 | table user, count, unique_ips", "reference": "index=windows EventCode=4740 | eval lockout_time=_time | stats earliest(lockout_time) as locked_time, values(src_ip) as lockout_ip by user | join user [search index=windows EventCode=4724 | eval reset_time=_time | stats latest(reset_time) as password_reset_time, values(src_ip) as reset_ip by user] | where password_reset_time > locked_time AND password_reset_time < (locked_time + 7200) AND lockout_ip!=reset_ip", "exact_match": 0.0, "normalized_exact_match": 0.0, "token_overlap": 0.4225352112676056, "command_accuracy": 0.9090909090909091, "syntax_valid": true, "clarification_match": 1.0, "instruction": "Detect account lockouts followed by password resets from different IP"}}
{"id": 9, "instruction": "Find privilege escalation attempts", "input": "", "reference": "index=windows (EventCode=4672 OR EventCode=4673 OR EventCode=4674) Privileges=\"*SeDebugPrivilege*\" | stats count by user, host", "prediction": "index=windows EventCode=4672 Object_Name=\"*Backup Operators*\" | stats count by user, host | where count > 1 |", "metrics": {"id": 9, "prediction": "index=windows EventCode=4672 Object_Name=\"*Backup Operators*\" | stats count by user, host | where count > 1 |", "reference": "index=windows (EventCode=4672 OR EventCode=4673 OR EventCode=4674) Privileges=\"*SeDebugPrivilege*\" | stats count by user, host", "exact_match": 0.0, "normalized_exact_match": 0.0, "token_overlap": 0.5599999999999999, "command_accuracy": 0.6666666666666666, "syntax_valid": true, "clarification_match": 1.0, "instruction": "Find privilege escalation attempts"}}
