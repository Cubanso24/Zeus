{"instruction": "test query", "input": "", "output": "index=* | head 10"}
{"instruction": "Look for any registry changes", "input": "", "output": "index=windows EventCode=4657 | table _time, Computer, Key_Name, Old_Value, New_Value | where isnotnull(Old_Value) AND isnotnull(New_Value) | eval change=if(Old_Value!=New_Value, "}
{"instruction": "Find failed SSH login attempts in the last 24 hours", "input": "", "output": "index=* sourcetype=zeek:conn | transaction user, src_ip | where status!=200 AND (status<10 OR status>99) | stats count by user, src_ip | sort -count | head 50 | table _time id.orig_h host user count | timechart span=30m count as total | eval rate = round((total / duration()) * 60, 2) | eval percentage = round(((count / total) * 100), 2) | eval threshold = ((rate > 10) OR (percentage > 5)) | where threshold | table _time id.orig_h host user count rate percentage"}
{"instruction": "Give me a splunk query to identify all ssh connections", "input": "", "output": "index=* sourcetype="}
{"instruction": "Show me all RDP connections", "input": "", "output": "index=* sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=1 | rex field=Image \"rdp\\.exe\" | table _time Computer User DestinationIP DestinationPort | stats count by Computer, User, DestinationIP, DestinationPort | sort -count | head 20 | eval rank=if(match(_time,\"Jan\") AND match(_time,\"Mon\"),1,0) OR (match(_time,\"Feb\") AND match(_time,\"Tue\"),1,0) OR (match(_time,\"Mar\") AND match(_time,\"Wed\"),1,0) OR (match(_time,\"Apr\") AND match(_time,\"Thu\"),1,0) OR (match(_time,\"May\") AND match(_time,\"Fri\"),1,0) OR (match(_time,\"Jun\") AND match(_time,\"Sat\"),1,0) OR (match(_time,\"Jul\") AND match(_time,\"Sun\"),1,0),rank) | where rank>0 | eval month=_time | eval day=_time | mvexpand month,day | stats count avg(count) as"}
